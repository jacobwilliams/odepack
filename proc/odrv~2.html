<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="ODEPACK - A Systematized Collection of ODE Solvers">
    <meta name="author" content="Alan C. Hindmarsh as modified by John S. Urban, Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>odrv &ndash; odepack</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
      <link href="../css/user.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">odepack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>odrv
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip"
                 data-bs-placement="bottom" data-html="true"
                 title=" 0.2% of total for procedures.">45 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/odrv.inc"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/odrv.inc.html'>odrv.inc</a></li>
            <li class="breadcrumb-item active" aria-current="page">odrv</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/odrv~2.html#variable-dflag~2">dflag</a>
            <a class="list-group-item" href="../proc/odrv~2.html#variable-head~2">head</a>
            <a class="list-group-item" href="../proc/odrv~2.html#variable-l~14">l</a>
            <a class="list-group-item" href="../proc/odrv~2.html#variable-max~4">max</a>
            <a class="list-group-item" href="../proc/odrv~2.html#variable-next~2">next</a>
            <a class="list-group-item" href="../proc/odrv~2.html#variable-q~4">q</a>
            <a class="list-group-item" href="../proc/odrv~2.html#variable-tmp~4">tmp</a>
            <a class="list-group-item" href="../proc/odrv~2.html#variable-v~5">v</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/odrv~2.html#src">odrv</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine odrv(N, Ia, Ja, A, P, Ip, Nsp, Isp, Path, Flag)  
</h2>
    

    <h3 id="name">Name</h3>
<p>odrv(3f) [M_odepack] - driver for sparse matrix reordering routines</p>
<h3 id="description">Description</h3>
<p>odrv finds a minimum degree ordering of the rows and columns
   of a matrix m stored in (ia,ja,a) format (see below).  for the
   reordered matrix, the work and storage required to perform
   gaussian elimination is (usually) significantly less.</p>
<p>note.. odrv and its subordinate routines have been modified to
   compute orderings for general matrices, not necessarily having any
   symmetry.  the miminum degree ordering is computed for the
   structure of the symmetric matrix  m + m-transpose.
   modifications to the original odrv module have been made in
   the coding in subroutine mdi, and in the initial comments in
   subroutines odrv and md.</p>
<p>if only the nonzero entries in the upper triangle of m are being
   stored, then odrv symmetrically reorders (ia,ja,a), (optionally)
   with the diagonal entries placed first in each row.  this is to
   ensure that if m(i,j) will be in the upper triangle of m with
   respect to the new ordering, then m(i,j) is stored in row i (and
   thus m(j,i) is not stored),  whereas if m(i,j) will be in the
   strict lower triangle of m, then m(j,i) is stored in row j (and
   thus m(i,j) is not stored).</p>
<h3 id="storage-of-sparse-matrices">storage of sparse matrices</h3>
<p>the nonzero entries of the matrix m are stored row-by-row in the
   array a.  to identify the individual nonzero entries in each row,
   we need to know in which column each entry lies.  these column
   indices are stored in the array ja.  i.e., if  a(k) = m(i,j),  then
   ja(k) = j.  to identify the individual rows, we need to know where
   each row starts.  these row pointers are stored in the array ia.
   i.e., if m(i,j) is the first nonzero entry (stored) in the i-th row
   and  a(k) = m(i,j),  then  ia(i) = k.  moreover, ia(n+1) points to
   the first location following the last element in the last row.
   thus, the number of entries in the i-th row is  ia(i+1) - ia(i),
   the nonzero entries in the i-th row are stored consecutively in</p>
<div class="codehilite"><pre><span></span><code>            a(ia(i)),  a(ia(i)+1),  ..., a(ia(i+1)-1),
</code></pre></div>

<p>and the corresponding column indices are stored consecutively in</p>
<div class="codehilite"><pre><span></span><code>            ja(ia(i)), ja(ia(i)+1), ..., ja(ia(i+1)-1).
</code></pre></div>

<p>when the coefficient matrix is symmetric, only the nonzero entries
   in the upper triangle need be stored.  for example, the matrix</p>
<div class="codehilite"><pre><span></span><code>             ( 1  0  2  3  0 )
             ( 0  4  0  0  0 )
         m = ( 2  0  5  6  0 )
             ( 3  0  6  7  8 )
             ( 0  0  0  8  9 )
</code></pre></div>

<p>could be stored as</p>
<div class="codehilite"><pre><span></span><code>            - 1  2  3  4  5  6  7  8  9 10 11 12 13
         ---+--------------------------------------
         ia - 1  4  5  8 12 14
         ja - 1  3  4  2  1  3  4  1  3  4  5  4  5
          a - 1  2  3  4  2  5  6  3  6  7  8  8  9
</code></pre></div>

<p>or (symmetrically) as</p>
<div class="codehilite"><pre><span></span><code>            - 1  2  3  4  5  6  7  8  9
         ---+--------------------------
         ia - 1  4  5  7  9 10
         ja - 1  3  4  2  3  4  4  5  5
          a - 1  2  3  4  5  6  7  8  9          .
</code></pre></div>

<h3 id="parameters">parameters</h3>
<div class="codehilite"><pre><span></span><code>    n    - order of the matrix

    ia   - integer one-dimensional array containing pointers to delimit
           rows in ja and a.  dimension = n+1

    ja   - integer one-dimensional array containing the column indices
           corresponding to the elements of a.  dimension = number of
           nonzero entries in (the upper triangle of) m

    a    - real one-dimensional array containing the nonzero entries in
           (the upper triangle of) m, stored by rows.  dimension =
           number of nonzero entries in (the upper triangle of) m

    p    - integer one-dimensional array used to return the permutation
           of the rows and columns of m corresponding to the minimum
           degree ordering.  dimension = n

    ip   - integer one-dimensional array used to return the inverse of
           the permutation returned in p.  dimension = n

    nsp  - declared dimension of the one-dimensional array isp.  nsp
           must be at least  3n+4k,  where k is the number of nonzeroes
           in the strict upper triangle of m

    isp  - integer one-dimensional array used for working storage.
           dimension = nsp

    path - integer path specification.  values and their meanings are -
             1  find minimum degree ordering only
             2  find minimum degree ordering and reorder symmetrically
                  stored matrix (used when only the nonzero entries in
                  the upper triangle of m are being stored)
             3  reorder symmetrically stored matrix as specified by
                  input permutation (used when an ordering has already
                  been determined and only the nonzero entries in the
                  upper triangle of m are being stored)
             4  same as 2 but put diagonal entries at start of each row
             5  same as 3 but put diagonal entries at start of each row

    flag - integer error flag.  values and their meanings are -
               0    no errors detected
              9n+k  insufficient storage in md
             10n+1  insufficient storage in odrv
             11n+1  illegal path specification
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~53"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ia~21"></span>
              integer,
            </td>
<td></td>
              <td></td>            <td>
              dimension(*)
            </td>
            <td>::</td>
            <td><strong>Ia</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ja~21"></span>
              integer,
            </td>
<td></td>
              <td></td>            <td>
              dimension(*)
            </td>
            <td>::</td>
            <td><strong>Ja</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a~19"></span>
              real(kind=dp),
            </td>
<td></td>
              <td></td>            <td>
              dimension(*)
            </td>
            <td>::</td>
            <td><strong>A</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p~7"></span>
              integer,
            </td>
<td></td>
              <td></td>            <td>
              dimension(*)
            </td>
            <td>::</td>
            <td><strong>P</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ip~5"></span>
              integer,
            </td>
<td></td>
              <td></td>            <td>
              dimension(*)
            </td>
            <td>::</td>
            <td><strong>Ip</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsp~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nsp</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isp~5"></span>
              integer,
            </td>
<td></td>
              <td></td>            <td>
              dimension(*)
            </td>
            <td>::</td>
            <td><strong>Isp</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-path~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Path</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-flag~10"></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Flag</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~odrv~2~~CallsGraph Pages: 1 -->
<svg id="procodrv2CallsGraph" width="184pt" height="74pt"
 viewBox="0.00 0.00 184.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~odrv~2~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>proc~~odrv~2~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-70 180,-70 180,4 -4,4"/>
<!-- proc~odrv~2 -->
<g id="proc~~odrv~2~~CallsGraph_node1" class="node">
<title>proc~odrv~2</title>
<polygon fill="none" stroke="black" points="86,-45 0,-45 0,-21 86,-21 86,-45"/>
<text text-anchor="middle" x="43" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">odrv.inc::odrv</text>
</g>
<!-- md -->
<g id="proc~~odrv~2~~CallsGraph_node2" class="node">
<title>md</title>
<polygon fill="#777777" stroke="#777777" points="176,-66 122,-66 122,-42 176,-42 176,-66"/>
<text text-anchor="middle" x="149" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">md</text>
</g>
<!-- proc~odrv~2&#45;&gt;md -->
<g id="proc~~odrv~2~~CallsGraph_edge1" class="edge">
<title>proc~odrv~2&#45;&gt;md</title>
<path fill="none" stroke="#000000" d="M86,-41.48C94.58,-43.21 103.53,-45.02 111.88,-46.71"/>
<polygon fill="#000000" stroke="#000000" points="111.21,-50.14 121.7,-48.69 112.59,-43.28 111.21,-50.14"/>
</g>
<!-- sro -->
<g id="proc~~odrv~2~~CallsGraph_node3" class="node">
<title>sro</title>
<polygon fill="#777777" stroke="#777777" points="176,-24 122,-24 122,0 176,0 176,-24"/>
<text text-anchor="middle" x="149" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sro</text>
</g>
<!-- proc~odrv~2&#45;&gt;sro -->
<g id="proc~~odrv~2~~CallsGraph_edge2" class="edge">
<title>proc~odrv~2&#45;&gt;sro</title>
<path fill="none" stroke="#000000" d="M86,-24.52C94.58,-22.79 103.53,-20.98 111.88,-19.29"/>
<polygon fill="#000000" stroke="#000000" points="112.59,-22.72 121.7,-17.31 111.21,-15.86 112.59,-22.72"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.16 1.16) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-dflag~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dflag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-head~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>head</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-l~14"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>l</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>max</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-next~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>next</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-q~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>q</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tmp~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-v~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>v</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="k">subroutine </span><span class="n">odrv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Ia</span><span class="p">,</span><span class="n">Ja</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Ip</span><span class="p">,</span><span class="n">Nsp</span><span class="p">,</span><span class="n">Isp</span><span class="p">,</span><span class="n">Path</span><span class="p">,</span><span class="n">Flag</span><span class="p">)</span>

<span class="kt">integer</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">N</span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">Ia</span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">Ja</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w">  </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">P</span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">Ip</span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">Nsp</span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">Isp</span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">Path</span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">Flag</span>

<span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dflag</span>
<span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">head</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="n">v</span>

<span class="w">   </span><span class="c">!----initialize error flag and validate path specification</span>
<span class="w">   </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Path</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="mi">5</span><span class="o">&lt;</span><span class="n">Path</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">      </span><span class="c">!  ** error -- illegal path specified</span>
<span class="w">      </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="k">return</span>

<span class="k">   else</span>

<span class="w">      </span><span class="c">!----allocate storage and find minimum degree ordering</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="nb">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Nsp</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="w">         </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">         </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span>
<span class="nb">         </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span>
<span class="nb">         </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">max</span><span class="o">&lt;</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">return</span>
<span class="k">         endif</span>

<span class="k">         call </span><span class="n">md</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Ia</span><span class="p">,</span><span class="n">Ja</span><span class="p">,</span><span class="nb">max</span><span class="p">,</span><span class="n">Isp</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="n">Isp</span><span class="p">(</span><span class="n">l</span><span class="p">),</span><span class="n">Isp</span><span class="p">(</span><span class="n">head</span><span class="p">),</span><span class="n">P</span><span class="p">,</span><span class="n">Ip</span><span class="p">,</span><span class="n">Isp</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="n">Flag</span><span class="p">)</span>

<span class="w">         </span><span class="c">!  ** error -- error detected in md</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Flag</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<span class="k">      endif</span>

<span class="w">      </span><span class="c">!----allocate storage and symmetrically reorder matrix</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Nsp</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span>
<span class="w">         </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">Ia</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">then</span>
<span class="k">            </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">return</span>
<span class="k">         endif</span>

<span class="k">         </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="o">==</span><span class="mi">4</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">Path</span><span class="o">==</span><span class="mi">5</span>
<span class="w">         </span><span class="k">call </span><span class="n">sro</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Ip</span><span class="p">,</span><span class="n">Ia</span><span class="p">,</span><span class="n">Ja</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Isp</span><span class="p">(</span><span class="n">tmp</span><span class="p">),</span><span class="n">Isp</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="n">dflag</span><span class="p">)</span>
<span class="w">      </span><span class="k">endif</span>

<span class="k">      return</span>
<span class="k">   endif</span>

<span class="w">   </span><span class="c">!  ** error -- insufficient storage</span>
<span class="w">   </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>

<span class="k">end subroutine </span><span class="n">odrv</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col"><p>odepack was developed by Alan C. Hindmarsh as modified by John S. Urban, Jacob Williams<br>&copy; 2024 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-03-29 08:21              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>