<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="ODEPACK - A Systematized Collection of ODE Solvers">
    <meta name="author" content="Alan C. Hindmarsh as modified by John S. Urban, Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>odrv &ndash; odepack</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <link href="../css/user.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">odepack </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
              
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                                       </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>odrv
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">45 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/odrv.inc"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/odrv.inc.html'>odrv.inc</a></li>
     <li class="active">odrv</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../proc/odrv~2.html#variable-dflag">dflag</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-head">head</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-l~3">l</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-max~2">max</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-next">next</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-q~2">q</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-tmp~2">tmp</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-v~3">v</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/odrv~2.html#src">odrv</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>subroutine odrv(N, Ia, Ja, A, P, Ip, Nsp, Isp, Path, Flag)</h2>
    

    <h3 id="name">Name</h3>
<p>odrv(3f) [M_odepack] - driver for sparse matrix reordering routines</p>
<h3 id="description">Description</h3>
<p>odrv finds a minimum degree ordering of the rows and columns
   of a matrix m stored in (ia,ja,a) format (see below).  for the
   reordered matrix, the work and storage required to perform
   gaussian elimination is (usually) significantly less.</p>
<p>note.. odrv and its subordinate routines have been modified to
   compute orderings for general matrices, not necessarily having any
   symmetry.  the miminum degree ordering is computed for the
   structure of the symmetric matrix  m + m-transpose.
   modifications to the original odrv module have been made in
   the coding in subroutine mdi, and in the initial comments in
   subroutines odrv and md.</p>
<p>if only the nonzero entries in the upper triangle of m are being
   stored, then odrv symmetrically reorders (ia,ja,a), (optionally)
   with the diagonal entries placed first in each row.  this is to
   ensure that if m(i,j) will be in the upper triangle of m with
   respect to the new ordering, then m(i,j) is stored in row i (and
   thus m(j,i) is not stored),  whereas if m(i,j) will be in the
   strict lower triangle of m, then m(j,i) is stored in row j (and
   thus m(i,j) is not stored).</p>
<h3 id="storage-of-sparse-matrices">storage of sparse matrices</h3>
<p>the nonzero entries of the matrix m are stored row-by-row in the
   array a.  to identify the individual nonzero entries in each row,
   we need to know in which column each entry lies.  these column
   indices are stored in the array ja.  i.e., if  a(k) = m(i,j),  then
   ja(k) = j.  to identify the individual rows, we need to know where
   each row starts.  these row pointers are stored in the array ia.
   i.e., if m(i,j) is the first nonzero entry (stored) in the i-th row
   and  a(k) = m(i,j),  then  ia(i) = k.  moreover, ia(n+1) points to
   the first location following the last element in the last row.
   thus, the number of entries in the i-th row is  ia(i+1) - ia(i),
   the nonzero entries in the i-th row are stored consecutively in</p>
<div class="codehilite"><pre><span></span><code>            a(ia(i)),  a(ia(i)+1),  ..., a(ia(i+1)-1),
</code></pre></div>

<p>and the corresponding column indices are stored consecutively in</p>
<div class="codehilite"><pre><span></span><code>            ja(ia(i)), ja(ia(i)+1), ..., ja(ia(i+1)-1).
</code></pre></div>

<p>when the coefficient matrix is symmetric, only the nonzero entries
   in the upper triangle need be stored.  for example, the matrix</p>
<div class="codehilite"><pre><span></span><code>             ( 1  0  2  3  0 )
             ( 0  4  0  0  0 )
         m = ( 2  0  5  6  0 )
             ( 3  0  6  7  8 )
             ( 0  0  0  8  9 )
</code></pre></div>

<p>could be stored as</p>
<div class="codehilite"><pre><span></span><code>            - 1  2  3  4  5  6  7  8  9 10 11 12 13
         ---+--------------------------------------
         ia - 1  4  5  8 12 14
         ja - 1  3  4  2  1  3  4  1  3  4  5  4  5
          a - 1  2  3  4  2  5  6  3  6  7  8  8  9
</code></pre></div>

<p>or (symmetrically) as</p>
<div class="codehilite"><pre><span></span><code>            - 1  2  3  4  5  6  7  8  9
         ---+--------------------------
         ia - 1  4  5  7  9 10
         ja - 1  3  4  2  3  4  4  5  5
          a - 1  2  3  4  5  6  7  8  9          .
</code></pre></div>

<h3 id="parameters">parameters</h3>
<div class="codehilite"><pre><span></span><code>    n    - order of the matrix

    ia   - integer one-dimensional array containing pointers to delimit
           rows in ja and a.  dimension = n+1

    ja   - integer one-dimensional array containing the column indices
           corresponding to the elements of a.  dimension = number of
           nonzero entries in (the upper triangle of) m

    a    - real one-dimensional array containing the nonzero entries in
           (the upper triangle of) m, stored by rows.  dimension =
           number of nonzero entries in (the upper triangle of) m

    p    - integer one-dimensional array used to return the permutation
           of the rows and columns of m corresponding to the minimum
           degree ordering.  dimension = n

    ip   - integer one-dimensional array used to return the inverse of
           the permutation returned in p.  dimension = n

    nsp  - declared dimension of the one-dimensional array isp.  nsp
           must be at least  3n+4k,  where k is the number of nonzeroes
           in the strict upper triangle of m

    isp  - integer one-dimensional array used for working storage.
           dimension = nsp

    path - integer path specification.  values and their meanings are -
             1  find minimum degree ordering only
             2  find minimum degree ordering and reorder symmetrically
                  stored matrix (used when only the nonzero entries in
                  the upper triangle of m are being stored)
             3  reorder symmetrically stored matrix as specified by
                  input permutation (used when an ordering has already
                  been determined and only the nonzero entries in the
                  upper triangle of m are being stored)
             4  same as 2 but put diagonal entries at start of each row
             5  same as 3 but put diagonal entries at start of each row

    flag - integer error flag.  values and their meanings are -
               0    no errors detected
              9n+k  insufficient storage in md
             10n+1  insufficient storage in odrv
             11n+1  illegal path specification
</code></pre></div>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-n~18"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>N</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ia~11"></span>integer,</td>
<td></td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>Ia</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ja~11"></span>integer,</td>
<td></td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>Ja</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-a~9"></span>real(kind=dp),</td>
<td></td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>A</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-p~3"></span>integer,</td>
<td></td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>P</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ip~3"></span>integer,</td>
<td></td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>Ip</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nsp~2"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Nsp</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-isp~3"></span>integer,</td>
<td></td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>Isp</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-path~2"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Path</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-flag~5"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Flag</strong></td><td></td>
</tr>
</tbody>
</table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~odrv~2~~CallsGraph Pages: 1 -->
<svg id="procodrv2CallsGraph" width="242pt" height="158pt"
 viewBox="0.00 0.00 242.00 158.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~odrv~2~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 154)">
<title>proc~~odrv~2~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-154 238,-154 238,4 -4,4"/>
<!-- proc~odrv~2 -->
<g id="proc~~odrv~2~~CallsGraph_node1" class="node">
<title>proc~odrv~2</title>
<polygon fill="none" stroke="black" points="54,-66 0,-66 0,-42 54,-42 54,-66"/>
<text text-anchor="middle" x="27" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">odrv</text>
</g>
<!-- proc~md~2 -->
<g id="proc~~odrv~2~~CallsGraph_node2" class="node">
<title>proc~md~2</title>
<g id="a_proc~~odrv~2~~CallsGraph_node2"><a xlink:href=".././proc/md~2.html" xlink:title="md">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-87 90,-87 90,-63 144,-63 144,-87"/>
<text text-anchor="middle" x="117" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">md</text>
</a>
</g>
</g>
<!-- proc~odrv~2&#45;&gt;proc~md~2 -->
<g id="proc~~odrv~2~~CallsGraph_edge1" class="edge">
<title>proc~odrv~2&#45;&gt;proc~md~2</title>
<path fill="none" stroke="#000000" d="M54.4,-60.3C62.48,-62.23 71.51,-64.38 80.1,-66.43"/>
<polygon fill="#000000" stroke="#000000" points="79.38,-69.86 89.92,-68.78 81,-63.05 79.38,-69.86"/>
</g>
<!-- proc~sro~2 -->
<g id="proc~~odrv~2~~CallsGraph_node3" class="node">
<title>proc~sro~2</title>
<g id="a_proc~~odrv~2~~CallsGraph_node3"><a xlink:href=".././proc/sro~2.html" xlink:title="sro">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-45 90,-45 90,-21 144,-21 144,-45"/>
<text text-anchor="middle" x="117" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sro</text>
</a>
</g>
</g>
<!-- proc~odrv~2&#45;&gt;proc~sro~2 -->
<g id="proc~~odrv~2~~CallsGraph_edge2" class="edge">
<title>proc~odrv~2&#45;&gt;proc~sro~2</title>
<path fill="none" stroke="#000000" d="M54.4,-47.7C62.48,-45.77 71.51,-43.62 80.1,-41.57"/>
<polygon fill="#000000" stroke="#000000" points="81,-44.95 89.92,-39.22 79.38,-38.14 81,-44.95"/>
</g>
<!-- proc~mdi~2 -->
<g id="proc~~odrv~2~~CallsGraph_node4" class="node">
<title>proc~mdi~2</title>
<g id="a_proc~~odrv~2~~CallsGraph_node4"><a xlink:href=".././proc/mdi~2.html" xlink:title="mdi">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-150 180,-150 180,-126 234,-126 234,-150"/>
<text text-anchor="middle" x="207" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mdi</text>
</a>
</g>
</g>
<!-- proc~md~2&#45;&gt;proc~mdi~2 -->
<g id="proc~~odrv~2~~CallsGraph_edge3" class="edge">
<title>proc~md~2&#45;&gt;proc~mdi~2</title>
<path fill="none" stroke="#000000" d="M134.97,-87.15C147.99,-96.47 166.18,-109.49 180.89,-120.02"/>
<polygon fill="#000000" stroke="#000000" points="178.92,-122.91 189.08,-125.89 182.99,-117.22 178.92,-122.91"/>
</g>
<!-- proc~mdm~2 -->
<g id="proc~~odrv~2~~CallsGraph_node5" class="node">
<title>proc~mdm~2</title>
<g id="a_proc~~odrv~2~~CallsGraph_node5"><a xlink:href=".././proc/mdm~2.html" xlink:title="mdm">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-108 180,-108 180,-84 234,-84 234,-108"/>
<text text-anchor="middle" x="207" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mdm</text>
</a>
</g>
</g>
<!-- proc~md~2&#45;&gt;proc~mdm~2 -->
<g id="proc~~odrv~2~~CallsGraph_edge4" class="edge">
<title>proc~md~2&#45;&gt;proc~mdm~2</title>
<path fill="none" stroke="#000000" d="M144.4,-81.3C152.48,-83.23 161.51,-85.38 170.1,-87.43"/>
<polygon fill="#000000" stroke="#000000" points="169.38,-90.86 179.92,-89.78 171,-84.05 169.38,-90.86"/>
</g>
<!-- proc~mdp~2 -->
<g id="proc~~odrv~2~~CallsGraph_node6" class="node">
<title>proc~mdp~2</title>
<g id="a_proc~~odrv~2~~CallsGraph_node6"><a xlink:href=".././proc/mdp~2.html" xlink:title="mdp">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-66 180,-66 180,-42 234,-42 234,-66"/>
<text text-anchor="middle" x="207" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mdp</text>
</a>
</g>
</g>
<!-- proc~md~2&#45;&gt;proc~mdp~2 -->
<g id="proc~~odrv~2~~CallsGraph_edge5" class="edge">
<title>proc~md~2&#45;&gt;proc~mdp~2</title>
<path fill="none" stroke="#000000" d="M144.4,-68.7C152.48,-66.77 161.51,-64.62 170.1,-62.57"/>
<polygon fill="#000000" stroke="#000000" points="171,-65.95 179.92,-60.22 169.38,-59.14 171,-65.95"/>
</g>
<!-- proc~mdu~2 -->
<g id="proc~~odrv~2~~CallsGraph_node7" class="node">
<title>proc~mdu~2</title>
<g id="a_proc~~odrv~2~~CallsGraph_node7"><a xlink:href=".././proc/mdu~2.html" xlink:title="mdu">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 180,-24 180,0 234,0 234,-24"/>
<text text-anchor="middle" x="207" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mdu</text>
</a>
</g>
</g>
<!-- proc~md~2&#45;&gt;proc~mdu~2 -->
<g id="proc~~odrv~2~~CallsGraph_edge6" class="edge">
<title>proc~md~2&#45;&gt;proc~mdu~2</title>
<path fill="none" stroke="#000000" d="M134.97,-62.85C147.99,-53.53 166.18,-40.51 180.89,-29.98"/>
<polygon fill="#000000" stroke="#000000" points="182.99,-32.78 189.08,-24.11 178.92,-27.09 182.99,-32.78"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../proc/odrv~2.html#variable-dflag">dflag</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-head">head</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-l~3">l</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-max~2">max</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-next">next</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-q~2">q</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-tmp~2">tmp</a>
      <a class="list-group-item" href="../proc/odrv~2.html#variable-v~3">v</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/odrv~2.html#src">odrv</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    <section>    
      <h2>Variables</h2>
    <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th><th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-dflag"></span>logical,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>dflag</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-head"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>head</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-l~3"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>l</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-max~2"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>max</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-next"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>next</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-q~2"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>q</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-tmp~2"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>tmp</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-v~3"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>v</strong></td><td></td><td></td><td></td>
</tr>
</tbody>
</table>

    </section>
    <br>
    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">odrv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Ia</span><span class="p">,</span><span class="n">Ja</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Ip</span><span class="p">,</span><span class="n">Nsp</span><span class="p">,</span><span class="n">Isp</span><span class="p">,</span><span class="n">Path</span><span class="p">,</span><span class="n">Flag</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="kt">integer</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">Ia</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">Ja</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w">  </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">P</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">Ip</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">Nsp</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">Isp</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">Path</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="w">        </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">Flag</span><span class="w"></span>
<span class="w"> </span>
<span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dflag</span><span class="w"></span>
<span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">head</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"></span>

<span class="w">   </span><span class="c">!----initialize error flag and validate path specification</span>
<span class="w">   </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Path</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="mi">5</span><span class="o">&lt;</span><span class="n">Path</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>

<span class="w">      </span><span class="c">!  ** error -- illegal path specified</span>
<span class="w">      </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span>

<span class="k">   else</span><span class="w"></span>
<span class="w">     </span>
<span class="w">      </span><span class="c">!----allocate storage and find minimum degree ordering</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="nb">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Nsp</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="w"></span>
<span class="w">         </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span>
<span class="nb">         </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span>
<span class="nb">         </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">max</span><span class="o">&lt;</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span>
<span class="k">         endif</span>
<span class="k">     </span>
<span class="k">         call </span><span class="n">md</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Ia</span><span class="p">,</span><span class="n">Ja</span><span class="p">,</span><span class="nb">max</span><span class="p">,</span><span class="n">Isp</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="n">Isp</span><span class="p">(</span><span class="n">l</span><span class="p">),</span><span class="n">Isp</span><span class="p">(</span><span class="n">head</span><span class="p">),</span><span class="n">P</span><span class="p">,</span><span class="n">Ip</span><span class="p">,</span><span class="n">Isp</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="n">Flag</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span>
<span class="w">         </span><span class="c">!  ** error -- error detected in md</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Flag</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">     </span>
<span class="w">      </span><span class="c">!----allocate storage and symmetrically reorder matrix</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Path</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Nsp</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">Ia</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">then</span>
<span class="k">            </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span>
<span class="k">         endif</span>
<span class="k">     </span>
<span class="k">         </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="o">==</span><span class="mi">4</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">Path</span><span class="o">==</span><span class="mi">5</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">sro</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Ip</span><span class="p">,</span><span class="n">Ia</span><span class="p">,</span><span class="n">Ja</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Isp</span><span class="p">(</span><span class="n">tmp</span><span class="p">),</span><span class="n">Isp</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="n">dflag</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">     </span>
<span class="k">      return</span>
<span class="k">   endif</span><span class="w"></span>

<span class="w">   </span><span class="c">!  ** error -- insufficient storage</span>
<span class="w">   </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="k">end subroutine </span><span class="n">odrv</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>odepack was developed by Alan C. Hindmarsh as modified by John S. Urban, Jacob Williams<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-10-13 16:03            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>