<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="ODEPACK - A Systematized Collection of ODE Solvers">
    <meta name="author" content="Alan C. Hindmarsh as modified by John S. Urban, Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>nroc &ndash; odepack</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <link href="../css/user.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">odepack </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
              
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                                       </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>nroc
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">42 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/nroc.inc"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/nroc.inc.html'>nroc.inc</a></li>
     <li class="active">nroc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../proc/nroc~2.html#variable-i~19">i</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-j~11">j</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-jmax">jmax</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-jmin">jmin</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-k~7">k</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-newj">newj</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/nroc~2.html#src">nroc</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>subroutine nroc(N, Ic, Ia, Ja, A, Jar, Ar, P, Flag)</h2>
    

    <div class="codehilite"><pre><span></span><code>           yale sparse matrix package - nonsymmetric codes
                solving the system of equations mx = b
</code></pre></div>

<h3 id="i-calling-sequences">i.   calling sequences</h3>
<div class="codehilite"><pre><span></span><code>     <span class="nv">the</span> <span class="nv">coefficient</span> <span class="nv">matrix</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">processed</span> <span class="nv">by</span> <span class="nv">an</span> <span class="nv">ordering</span> <span class="nv">routine</span>
<span class="ss">(</span><span class="nv">e</span>.<span class="nv">g</span>., <span class="nv">to</span> <span class="nv">reduce</span> <span class="nv">fillin</span> <span class="nv">or</span> <span class="nv">ensure</span> <span class="nv">numerical</span> <span class="nv">stability</span><span class="ss">)</span> <span class="nv">before</span> <span class="nv">using</span>
<span class="nv">the</span> <span class="nv">remaining</span> <span class="nv">subroutines</span>.  <span class="k">if</span> <span class="nv">no</span> <span class="nv">reordering</span> <span class="nv">is</span> <span class="nv">done</span>, <span class="k">then</span> <span class="nv">set</span>
<span class="nv">r</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">c</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">ic</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">i</span>  <span class="k">for</span> <span class="nv">i</span><span class="o">=</span><span class="mi">1</span>,...,<span class="nv">n</span>.  <span class="k">if</span> <span class="nv">an</span> <span class="nv">ordering</span> <span class="nv">subroutine</span>
<span class="nv">is</span> <span class="nv">used</span>, <span class="k">then</span> <span class="nv">nroc</span> <span class="nv">should</span> <span class="nv">be</span> <span class="nv">used</span> <span class="nv">to</span> <span class="nv">reorder</span> <span class="nv">the</span> <span class="nv">coefficient</span> <span class="nv">matrix</span>
</code></pre></div>

<h3 id="the-calling-sequence-is-">the calling sequence is &ndash;</h3>
<div class="codehilite"><pre><span></span><code>        (       (matrix ordering))
        (nroc   (matrix reordering))
         nsfc   (symbolic factorization to determine where fillin will
                  occur during numeric factorization)
         nnfc   (numeric factorization into product ldu of unit lower
                  triangular matrix l, diagonal matrix d, and unit
                  upper triangular matrix u, and solution of linear
                  system)
         nnsc   (solution of linear system for additional right-hand
                  side using ldu factorization from nnfc)
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="ss">(</span><span class="k">if</span> <span class="nv">only</span> <span class="nv">one</span> <span class="nv">system</span> <span class="nv">of</span> <span class="nv">equations</span> <span class="nv">is</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">solved</span>, <span class="k">then</span> <span class="nv">the</span>
<span class="nv">subroutine</span> <span class="nv">trk</span> <span class="nv">should</span> <span class="nv">be</span> <span class="nv">used</span>.<span class="ss">)</span>
</code></pre></div>

<h3 id="ii-storage-of-sparse-matrices">ii.  storage of sparse matrices</h3>
<div class="codehilite"><pre><span></span><code>     <span class="nv">the</span> <span class="nv">nonzero</span> <span class="nv">entries</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">coefficient</span> <span class="nv">matrix</span> <span class="nv">m</span> <span class="nv">are</span> <span class="nv">stored</span>

<span class="nv">row</span><span class="o">-</span><span class="nv">by</span><span class="o">-</span><span class="nv">row</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">array</span> <span class="nv">a</span>.  <span class="nv">to</span> <span class="nv">identify</span> <span class="nv">the</span> <span class="nv">individual</span> <span class="nv">nonzero</span>
<span class="nv">entries</span> <span class="nv">in</span> <span class="nv">each</span> <span class="nv">row</span>, <span class="nv">we</span> <span class="nv">need</span> <span class="nv">to</span> <span class="nv">know</span> <span class="nv">in</span> <span class="nv">which</span> <span class="nv">column</span> <span class="nv">each</span> <span class="nv">entry</span>
<span class="nv">lies</span>.  <span class="nv">the</span> <span class="nv">column</span> <span class="nv">indices</span> <span class="nv">which</span> <span class="nv">correspond</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">nonzero</span> <span class="nv">entries</span>
<span class="nv">of</span> <span class="nv">m</span> <span class="nv">are</span> <span class="nv">stored</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">array</span> <span class="nv">ja</span>.  <span class="nv">i</span>.<span class="nv">e</span>., <span class="k">if</span>  <span class="nv">a</span><span class="ss">(</span><span class="nv">k</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">m</span><span class="ss">(</span><span class="nv">i</span>,<span class="nv">j</span><span class="ss">)</span>,  <span class="k">then</span>
<span class="nv">ja</span><span class="ss">(</span><span class="nv">k</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">j</span>.  <span class="nv">in</span> <span class="nv">addition</span>, <span class="nv">we</span> <span class="nv">need</span> <span class="nv">to</span> <span class="nv">know</span> <span class="nv">where</span> <span class="nv">each</span> <span class="nv">row</span> <span class="nv">starts</span> <span class="nv">and</span>
<span class="nv">how</span> <span class="nv">long</span> <span class="nv">it</span> <span class="nv">is</span>.  <span class="nv">the</span> <span class="nv">index</span> <span class="nv">positions</span> <span class="nv">in</span> <span class="nv">ja</span> <span class="nv">and</span> <span class="nv">a</span> <span class="nv">where</span> <span class="nv">the</span> <span class="nv">rows</span> <span class="nv">of</span>
<span class="nv">m</span> <span class="nv">begin</span> <span class="nv">are</span> <span class="nv">stored</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">array</span> <span class="nv">ia</span>.  <span class="nv">i</span>.<span class="nv">e</span>., <span class="k">if</span> <span class="nv">m</span><span class="ss">(</span><span class="nv">i</span>,<span class="nv">j</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">the</span> <span class="nv">first</span>
<span class="ss">(</span><span class="nv">leftmost</span><span class="ss">)</span> <span class="nv">entry</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">i</span><span class="o">-</span><span class="nv">th</span> <span class="nv">row</span> <span class="nv">and</span>  <span class="nv">a</span><span class="ss">(</span><span class="nv">k</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">m</span><span class="ss">(</span><span class="nv">i</span>,<span class="nv">j</span><span class="ss">)</span>,  <span class="k">then</span>
<span class="nv">ia</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">k</span>.  <span class="nv">moreover</span>, <span class="nv">the</span> <span class="nv">index</span> <span class="nv">in</span> <span class="nv">ja</span> <span class="nv">and</span> <span class="nv">a</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">first</span> <span class="nv">location</span>
<span class="nv">following</span> <span class="nv">the</span> <span class="nv">last</span> <span class="nv">element</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">last</span> <span class="nv">row</span> <span class="nv">is</span> <span class="nv">stored</span> <span class="nv">in</span> <span class="nv">ia</span><span class="ss">(</span><span class="nv">n</span><span class="o">+</span><span class="mi">1</span><span class="ss">)</span>.
<span class="nv">thus</span>, <span class="nv">the</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">entries</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">i</span><span class="o">-</span><span class="nv">th</span> <span class="nv">row</span> <span class="nv">is</span> <span class="nv">given</span> <span class="nv">by</span>
<span class="nv">ia</span><span class="ss">(</span><span class="nv">i</span><span class="o">+</span><span class="mi">1</span><span class="ss">)</span> <span class="o">-</span> <span class="nv">ia</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>,  <span class="nv">the</span> <span class="nv">nonzero</span> <span class="nv">entries</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">i</span><span class="o">-</span><span class="nv">th</span> <span class="nv">row</span> <span class="nv">are</span> <span class="nv">stored</span>
<span class="nv">consecutively</span> <span class="nv">in</span>

        <span class="nv">a</span><span class="ss">(</span><span class="nv">ia</span><span class="ss">(</span><span class="nv">i</span><span class="ss">))</span>,  <span class="nv">a</span><span class="ss">(</span><span class="nv">ia</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">+</span><span class="mi">1</span><span class="ss">)</span>,  ..., <span class="nv">a</span><span class="ss">(</span><span class="nv">ia</span><span class="ss">(</span><span class="nv">i</span><span class="o">+</span><span class="mi">1</span><span class="ss">)</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span>,

<span class="nv">and</span> <span class="nv">the</span> <span class="nv">corresponding</span> <span class="nv">column</span> <span class="nv">indices</span> <span class="nv">are</span> <span class="nv">stored</span> <span class="nv">consecutively</span> <span class="nv">in</span>

        <span class="nv">ja</span><span class="ss">(</span><span class="nv">ia</span><span class="ss">(</span><span class="nv">i</span><span class="ss">))</span>, <span class="nv">ja</span><span class="ss">(</span><span class="nv">ia</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">+</span><span class="mi">1</span><span class="ss">)</span>, ..., <span class="nv">ja</span><span class="ss">(</span><span class="nv">ia</span><span class="ss">(</span><span class="nv">i</span><span class="o">+</span><span class="mi">1</span><span class="ss">)</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span>.

<span class="k">for</span> <span class="nv">example</span>, <span class="nv">the</span> <span class="mi">5</span> <span class="nv">by</span> <span class="mi">5</span> <span class="nv">matrix</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>                ( 1. 0. 2. 0. 0.)
                ( 0. 3. 0. 0. 0.)
            m = ( 0. 4. 5. 6. 0.)
                ( 0. 0. 0. 7. 0.)
                ( 0. 0. 0. 8. 9.)
</code></pre></div>

<div class="codehilite"><pre><span></span><code>would be stored as
</code></pre></div>

<div class="codehilite"><pre><span></span><code>               - 1  2  3  4  5  6  7  8  9
            ---+--------------------------
            ia - 1  3  4  7  8 10
            ja - 1  3  2  2  3  4  4  4  5
             a - 1. 2. 3. 4. 5. 6. 7. 8. 9.         .
</code></pre></div>

<div class="codehilite"><pre><span></span><code>     <span class="nv">the</span> <span class="nv">strict</span> <span class="nv">upper</span> <span class="ss">(</span><span class="nv">lower</span><span class="ss">)</span> <span class="nv">triangular</span> <span class="nv">portion</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">matrix</span>
<span class="nv">u</span> <span class="ss">(</span><span class="nv">l</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">stored</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">similar</span> <span class="nv">fashion</span> <span class="nv">using</span> <span class="nv">the</span> <span class="nv">arrays</span>  <span class="nv">iu</span>, <span class="nv">ju</span>, <span class="nv">u</span>
<span class="ss">(</span><span class="nv">il</span>, <span class="nv">jl</span>, <span class="nv">l</span><span class="ss">)</span>  <span class="nv">except</span> <span class="nv">that</span> <span class="nv">an</span> <span class="nv">additional</span> <span class="nv">array</span> <span class="nv">iju</span> <span class="ss">(</span><span class="nv">ijl</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">used</span> <span class="nv">to</span>
<span class="nv">compress</span> <span class="nv">storage</span> <span class="nv">of</span> <span class="nv">ju</span> <span class="ss">(</span><span class="nv">jl</span><span class="ss">)</span> <span class="nv">by</span> <span class="nv">allowing</span> <span class="nv">some</span> <span class="nv">sequences</span> <span class="nv">of</span> <span class="nv">column</span>
<span class="ss">(</span><span class="nv">row</span><span class="ss">)</span> <span class="nv">indices</span> <span class="nv">to</span> <span class="nv">used</span> <span class="k">for</span> <span class="nv">more</span> <span class="nv">than</span> <span class="nv">one</span> <span class="nv">row</span> <span class="ss">(</span><span class="nv">column</span><span class="ss">)</span>  <span class="ss">(</span><span class="nv">n</span>.<span class="nv">b</span>., <span class="nv">l</span> <span class="nv">is</span>
<span class="nv">stored</span> <span class="nv">by</span> <span class="nv">columns</span><span class="ss">)</span>.  <span class="nv">iju</span><span class="ss">(</span><span class="nv">k</span><span class="ss">)</span> <span class="ss">(</span><span class="nv">ijl</span><span class="ss">(</span><span class="nv">k</span><span class="ss">))</span> <span class="nv">points</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">starting</span>
<span class="nv">location</span> <span class="nv">in</span> <span class="nv">ju</span> <span class="ss">(</span><span class="nv">jl</span><span class="ss">)</span> <span class="nv">of</span> <span class="nv">entries</span> <span class="k">for</span> <span class="nv">the</span> <span class="nv">kth</span> <span class="nv">row</span> <span class="ss">(</span><span class="nv">column</span><span class="ss">)</span>.
<span class="nv">compression</span> <span class="nv">in</span> <span class="nv">ju</span> <span class="ss">(</span><span class="nv">jl</span><span class="ss">)</span> <span class="nv">occurs</span> <span class="nv">in</span> <span class="nv">two</span> <span class="nv">ways</span>.  <span class="nv">first</span>, <span class="k">if</span> <span class="nv">a</span> <span class="nv">row</span>
<span class="ss">(</span><span class="nv">column</span><span class="ss">)</span> <span class="nv">i</span> <span class="nv">was</span> <span class="nv">merged</span> <span class="nv">into</span> <span class="nv">the</span> <span class="nv">current</span> <span class="nv">row</span> <span class="ss">(</span><span class="nv">column</span><span class="ss">)</span> <span class="nv">k</span>, <span class="nv">and</span> <span class="nv">the</span>
<span class="nv">number</span> <span class="nv">of</span> <span class="nv">elements</span> <span class="nv">merged</span> <span class="nv">in</span> <span class="nv">from</span> <span class="ss">(</span><span class="nv">the</span> <span class="nv">tail</span> <span class="nv">portion</span> <span class="nv">of</span><span class="ss">)</span> <span class="nv">row</span>
<span class="ss">(</span><span class="nv">column</span><span class="ss">)</span> <span class="nv">i</span> <span class="nv">is</span> <span class="nv">the</span> <span class="nv">same</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">final</span> <span class="nv">length</span> <span class="nv">of</span> <span class="nv">row</span> <span class="ss">(</span><span class="nv">column</span><span class="ss">)</span> <span class="nv">k</span>, <span class="k">then</span>
<span class="nv">the</span> <span class="nv">kth</span> <span class="nv">row</span> <span class="ss">(</span><span class="nv">column</span><span class="ss">)</span> <span class="nv">and</span> <span class="nv">the</span> <span class="nv">tail</span> <span class="nv">of</span> <span class="nv">row</span> <span class="ss">(</span><span class="nv">column</span><span class="ss">)</span> <span class="nv">i</span> <span class="nv">are</span> <span class="nv">identical</span>
<span class="nv">and</span> <span class="nv">iju</span><span class="ss">(</span><span class="nv">k</span><span class="ss">)</span> <span class="ss">(</span><span class="nv">ijl</span><span class="ss">(</span><span class="nv">k</span><span class="ss">))</span> <span class="nv">points</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">start</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">tail</span>.  <span class="nv">second</span>, <span class="k">if</span>
<span class="nv">some</span> <span class="nv">tail</span> <span class="nv">portion</span> <span class="nv">of</span> <span class="nv">the</span> <span class="ss">(</span><span class="nv">k</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span><span class="nv">st</span> <span class="nv">row</span> <span class="ss">(</span><span class="nv">column</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">identical</span> <span class="nv">to</span> <span class="nv">the</span>
<span class="nv">head</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">kth</span> <span class="nv">row</span> <span class="ss">(</span><span class="nv">column</span><span class="ss">)</span>, <span class="k">then</span> <span class="nv">iju</span><span class="ss">(</span><span class="nv">k</span><span class="ss">)</span> <span class="ss">(</span><span class="nv">ijl</span><span class="ss">(</span><span class="nv">k</span><span class="ss">))</span> <span class="nv">points</span> <span class="nv">to</span> <span class="nv">the</span>
<span class="nv">start</span> <span class="nv">of</span> <span class="nv">that</span> <span class="nv">tail</span> <span class="nv">portion</span>.  <span class="k">for</span> <span class="nv">example</span>, <span class="nv">the</span> <span class="nv">nonzero</span> <span class="nv">structure</span> <span class="nv">of</span>
<span class="nv">the</span> <span class="nv">strict</span> <span class="nv">upper</span> <span class="nv">triangular</span> <span class="nv">part</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">matrix</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>            d 0 x x x
            0 d 0 x x
            0 0 d x 0
            0 0 0 d x
            0 0 0 0 d
</code></pre></div>

<div class="codehilite"><pre><span></span><code>would be represented as
</code></pre></div>

<div class="codehilite"><pre><span></span><code>                - 1 2 3 4 5 6
            ----+------------
             iu - 1 4 6 7 8 8
             ju - 3 4 5 4
            iju - 1 2 4 3           .
</code></pre></div>

<div class="codehilite"><pre><span></span><code>the diagonal entries of l and u are assumed to be equal to one and
are not stored.  the array d contains the reciprocals of the
diagonal entries of the matrix d.
</code></pre></div>

<h3 id="iii-additional-storage-savings">iii. additional storage savings</h3>
<div class="codehilite"><pre><span></span><code>     <span class="nv">in</span> <span class="nv">nsfc</span>, <span class="nv">r</span> <span class="nv">and</span> <span class="nv">ic</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">the</span> <span class="nv">same</span> <span class="nv">array</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">calling</span>
<span class="nv">sequence</span> <span class="k">if</span> <span class="nv">no</span> <span class="nv">reordering</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">coefficient</span> <span class="nv">matrix</span> <span class="nv">has</span> <span class="nv">been</span> <span class="nv">done</span>.

     <span class="nv">in</span> <span class="nv">nnfc</span>, <span class="nv">r</span>, <span class="nv">c</span>, <span class="nv">and</span> <span class="nv">ic</span> <span class="nv">can</span> <span class="nv">all</span> <span class="nv">be</span> <span class="nv">the</span> <span class="nv">same</span> <span class="nv">array</span> <span class="k">if</span> <span class="nv">no</span>
<span class="nv">reordering</span> <span class="nv">has</span> <span class="nv">been</span> <span class="nv">done</span>.  <span class="k">if</span> <span class="nv">only</span> <span class="nv">the</span> <span class="nv">rows</span> <span class="nv">have</span> <span class="nv">been</span> <span class="nv">reordered</span>,
<span class="k">then</span> <span class="nv">c</span> <span class="nv">and</span> <span class="nv">ic</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">the</span> <span class="nv">same</span> <span class="nv">array</span>.  <span class="k">if</span> <span class="nv">the</span> <span class="nv">row</span> <span class="nv">and</span> <span class="nv">column</span>
<span class="nv">orderings</span> <span class="nv">are</span> <span class="nv">the</span> <span class="nv">same</span>, <span class="k">then</span> <span class="nv">r</span> <span class="nv">and</span> <span class="nv">c</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">the</span> <span class="nv">same</span> <span class="nv">array</span>.  <span class="nv">z</span> <span class="nv">and</span>
<span class="nv">row</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">the</span> <span class="nv">same</span> <span class="nv">array</span>.

     <span class="nv">in</span> <span class="nv">nnsc</span> <span class="nv">or</span> <span class="nv">nntc</span>, <span class="nv">r</span> <span class="nv">and</span> <span class="nv">c</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">the</span> <span class="nv">same</span> <span class="nv">array</span> <span class="k">if</span> <span class="nv">no</span>
<span class="nv">reordering</span> <span class="nv">has</span> <span class="nv">been</span> <span class="nv">done</span> <span class="nv">or</span> <span class="k">if</span> <span class="nv">the</span> <span class="nv">row</span> <span class="nv">and</span> <span class="nv">column</span> <span class="nv">orderings</span> <span class="nv">are</span> <span class="nv">the</span>
<span class="nv">same</span>.  <span class="nv">z</span> <span class="nv">and</span> <span class="nv">b</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">the</span> <span class="nv">same</span> <span class="nv">array</span>.  <span class="nv">however</span>, <span class="k">then</span> <span class="nv">b</span> <span class="nv">will</span> <span class="nv">be</span>
<span class="nv">destroyed</span>.
</code></pre></div>

<h3 id="iv-parameters">iv.  parameters</h3>
<div class="codehilite"><pre><span></span><code><span class="w">     </span><span class="n">following</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">programs</span><span class="o">.</span><span class="w">  </span><span class="n">names</span><span class="w"> </span><span class="n">are</span><span class="w"></span>
<span class="n">uniform</span><span class="w"> </span><span class="n">among</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">various</span><span class="w"> </span><span class="n">subroutines</span><span class="o">.</span><span class="w">  </span><span class="k">class</span><span class="w"> </span><span class="n">abbreviations</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="o">--</span><span class="w"></span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>       n - integer variable
       f - real variable
       v - supplies a value to a subroutine
       r - returns a result from a subroutine
       i - used internally by a subroutine
       a - array

 class - parameter
 ------+----------
 fva   - a     - nonzero entries of the coefficient matrix m, stored
       -           by rows.
       -           size = number of nonzero entries in m.
 fva   - b     - right-hand side b.
       -           size = n.
 nva   - c     - ordering of the columns of m.
       -           size = n.
 fvra  - d     - reciprocals of the diagonal entries of the matrix d.
       -           size = n.
 nr    - flag  - error flag.  values and their meanings are --
       -            0     no errors detected
       -            n+k   null row in a  --  row = k
       -           2n+k   duplicate entry in a  --  row = k
       -           3n+k   insufficient storage for jl  --  row = k
       -           4n+1   insufficient storage for l
       -           5n+k   null pivot  --  row = k
       -           6n+k   insufficient storage for ju  --  row = k
       -           7n+1   insufficient storage for u
       -           8n+k   zero pivot  --  row = k
 nva   - ia    - pointers to delimit the rows of a.
       -           size = n+1.
 nvra  - ijl   - pointers to the first element in each column in jl,
       -           used to compress storage in jl.
       -           size = n.
 nvra  - iju   - pointers to the first element in each row in ju, used
       -           to compress storage in ju.
       -           size = n.
 nvra  - il    - pointers to delimit the columns of l.
       -           size = n+1.
 nvra  - iu    - pointers to delimit the rows of u.
       -           size = n+1.
 nva   - ja    - column numbers corresponding to the elements of a.
       -           size = size of a.
 nvra  - jl    - row numbers corresponding to the elements of l.
       -           size = jlmax.
 nv    - jlmax - declared dimension of jl.  jlmax must be larger than
       -           the number of nonzeros in the strict lower triangle
       -           of m plus fillin minus compression.
 nvra  - ju    - column numbers corresponding to the elements of u.
       -           size = jumax.
 nv    - jumax - declared dimension of ju.  jumax must be larger than
       -           the number of nonzeros in the strict upper triangle
       -           of m plus fillin minus compression.
 fvra  - l     - nonzero entries in the strict lower triangular portion
       -           of the matrix l, stored by columns.
       -           size = lmax.
 nv    - lmax  - declared dimension of l.  lmax must be larger than
       -           the number of nonzeros in the strict lower triangle
       -           of m plus fillin  (il(n+1)-1 after nsfc).
 nv    - n     - number of variables/equations.
 nva   - r     - ordering of the rows of m.
       -           size = n.
 fvra  - u     - nonzero entries in the strict upper triangular portion
       -           of the matrix u, stored by rows.
       -           size = umax.
 nv    - umax  - declared dimension of u.  umax must be larger than
       -           the number of nonzeros in the strict upper triangle
       -           of m plus fillin  (iu(n+1)-1 after nsfc).
 fra   - z     - solution x.
       -           size = n.
</code></pre></div>

<div class="codehilite"><pre><span></span><code>   ----------------------------------------------------------------
</code></pre></div>

<h3 id="subroutine-nroc">subroutine nroc</h3>
<h3 id="reorders-rows-of-a-leaving-row-order-unchanged">reorders rows of a, leaving row order unchanged</h3>
<div class="codehilite"><pre><span></span><code>   input parameters.. n, ic, ia, ja, a
   output parameters.. ja, a, flag

   parameters used internally..
</code></pre></div>

<p>nia   - p     - at the kth step, p is a linked list of the reordered
       -           column indices of the kth row of a.  p(n+1) points
       -           to the first entry in the list.
       -           size = n+1.
 nia   - jar   - at the kth step,jar contains the elements of the
       -           reordered column indices of a.
       -           size = n.
 fia   - ar    - at the kth step, ar contains the elements of the
       -           reordered row of a.
       -           size = n.</p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-n~7"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>N</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ic~2"></span>integer,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>Ic</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ia~5"></span>integer,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>Ia</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ja~5"></span>integer,</td>
<td>intent(inout),</td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>Ja</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-a~3"></span>real(kind=dp),</td>
<td>intent(inout),</td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>A</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-jar"></span>integer,</td>
<td>intent(inout),</td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>Jar</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ar"></span>real(kind=dp),</td>
<td>intent(inout),</td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>Ar</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-p~2"></span>integer,</td>
<td>intent(inout),</td>
  <td></td>  <td>dimension(*)</td><td>::</td>
  <td><strong>P</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-flag"></span>integer,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Flag</strong></td><td></td>
</tr>
</tbody>
</table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~nroc~2~~CalledByGraph Pages: 1 -->
<svg id="procnroc2CalledByGraph" width="332pt" height="116pt"
 viewBox="0.00 0.00 332.00 116.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~nroc~2~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>proc~~nroc~2~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 328,-112 328,4 -4,4"/>
<!-- proc~nroc~2 -->
<g id="proc~~nroc~2~~CalledByGraph_node1" class="node">
<title>proc~nroc~2</title>
<polygon fill="none" stroke="black" points="324,-66 270,-66 270,-42 324,-42 324,-66"/>
<text text-anchor="middle" x="297" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">nroc</text>
</g>
<!-- proc~cdrv~2 -->
<g id="proc~~nroc~2~~CalledByGraph_node2" class="node">
<title>proc~cdrv~2</title>
<g id="a_proc~~nroc~2~~CalledByGraph_node2"><a xlink:href=".././proc/cdrv~2.html" xlink:title="cdrv">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-66 180,-66 180,-42 234,-42 234,-66"/>
<text text-anchor="middle" x="207" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cdrv</text>
</a>
</g>
</g>
<!-- proc~cdrv~2&#45;&gt;proc~nroc~2 -->
<g id="proc~~nroc~2~~CalledByGraph_edge1" class="edge">
<title>proc~cdrv~2&#45;&gt;proc~nroc~2</title>
<path fill="none" stroke="#000000" d="M234.4,-54C242.39,-54 251.31,-54 259.82,-54"/>
<polygon fill="#000000" stroke="#000000" points="259.92,-57.5 269.92,-54 259.92,-50.5 259.92,-57.5"/>
</g>
<!-- none~wrapup~3 -->
<g id="proc~~nroc~2~~CalledByGraph_node3" class="node">
<title>none~wrapup~3</title>
<polygon fill="#d9534f" stroke="#d9534f" points="144,-108 90,-108 90,-84 144,-84 144,-108"/>
<text text-anchor="middle" x="117" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wrapup</text>
</g>
<!-- none~wrapup~3&#45;&gt;proc~cdrv~2 -->
<g id="proc~~nroc~2~~CalledByGraph_edge2" class="edge">
<title>none~wrapup~3&#45;&gt;proc~cdrv~2</title>
<path fill="none" stroke="#000000" d="M143.45,-83.85C152.21,-79.67 162.17,-74.92 171.52,-70.46"/>
<polygon fill="#000000" stroke="#000000" points="173.09,-73.59 180.6,-66.12 170.07,-67.27 173.09,-73.59"/>
</g>
<!-- proc~dprjis~2 -->
<g id="proc~~nroc~2~~CalledByGraph_node4" class="node">
<title>proc~dprjis~2</title>
<g id="a_proc~~nroc~2~~CalledByGraph_node4"><a xlink:href=".././proc/dprjis~2.html" xlink:title="dprjis">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-66 90,-66 90,-42 144,-42 144,-66"/>
<text text-anchor="middle" x="117" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dprjis</text>
</a>
</g>
</g>
<!-- proc~dprjis~2&#45;&gt;proc~cdrv~2 -->
<g id="proc~~nroc~2~~CalledByGraph_edge3" class="edge">
<title>proc~dprjis~2&#45;&gt;proc~cdrv~2</title>
<path fill="none" stroke="#000000" d="M144.4,-54C152.39,-54 161.31,-54 169.82,-54"/>
<polygon fill="#000000" stroke="#000000" points="169.92,-57.5 179.92,-54 169.92,-50.5 169.92,-57.5"/>
</g>
<!-- proc~dsolss~2 -->
<g id="proc~~nroc~2~~CalledByGraph_node5" class="node">
<title>proc~dsolss~2</title>
<g id="a_proc~~nroc~2~~CalledByGraph_node5"><a xlink:href=".././proc/dsolss~2.html" xlink:title="dsolss">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-24 90,-24 90,0 144,0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dsolss</text>
</a>
</g>
</g>
<!-- proc~dsolss~2&#45;&gt;proc~cdrv~2 -->
<g id="proc~~nroc~2~~CalledByGraph_edge4" class="edge">
<title>proc~dsolss~2&#45;&gt;proc~cdrv~2</title>
<path fill="none" stroke="#000000" d="M143.45,-24.15C152.21,-28.33 162.17,-33.08 171.52,-37.54"/>
<polygon fill="#000000" stroke="#000000" points="170.07,-40.73 180.6,-41.88 173.09,-34.41 170.07,-40.73"/>
</g>
<!-- proc~dprjs~2 -->
<g id="proc~~nroc~2~~CalledByGraph_node6" class="node">
<title>proc~dprjs~2</title>
<g id="a_proc~~nroc~2~~CalledByGraph_node6"><a xlink:href=".././proc/dprjs~2.html" xlink:title="dprjs">
<polygon fill="#d9534f" stroke="#d9534f" points="54,-108 0,-108 0,-84 54,-84 54,-108"/>
<text text-anchor="middle" x="27" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dprjs</text>
</a>
</g>
</g>
<!-- proc~dprjs~2&#45;&gt;none~wrapup~3 -->
<g id="proc~~nroc~2~~CalledByGraph_edge5" class="edge">
<title>proc~dprjs~2&#45;&gt;none~wrapup~3</title>
<path fill="none" stroke="#000000" d="M54.4,-96C62.39,-96 71.31,-96 79.82,-96"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-99.5 89.92,-96 79.92,-92.5 79.92,-99.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../proc/nroc~2.html#variable-i~19">i</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-j~11">j</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-jmax">jmax</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-jmin">jmin</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-k~7">k</a>
      <a class="list-group-item" href="../proc/nroc~2.html#variable-newj">newj</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/nroc~2.html#src">nroc</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    <section>    
      <h2>Variables</h2>
    <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th><th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-i~19"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>i</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-j~11"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>j</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-jmax"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>jmax</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-jmin"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>jmin</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-k~7"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-newj"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>newj</strong></td><td></td><td></td><td></td>
</tr>
</tbody>
</table>

    </section>
    <br>
    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">subroutine </span><span class="n">nroc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Ic</span><span class="p">,</span><span class="n">Ia</span><span class="p">,</span><span class="n">Ja</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Jar</span><span class="p">,</span><span class="n">Ar</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Flag</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!      real  a(*), ar(*)</span>
<span class="kt">integer</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="kt">integer</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Ic</span><span class="w"></span>
<span class="kt">integer</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Ia</span><span class="w"></span>
<span class="kt">integer</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Ja</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="w"></span>
<span class="kt">integer</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Jar</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Ar</span><span class="w"></span>
<span class="kt">integer</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">P</span><span class="w"></span>
<span class="kt">integer</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Flag</span><span class="w"></span>
<span class="c">!</span>
<span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jmax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">newj</span><span class="w"></span>
<span class="w">   </span><span class="c">!</span>
<span class="w">   </span><span class="c">!   ******  for each nonempty row  *******************************</span>
<span class="w">   </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="n">jmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ia</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">jmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ia</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jmin</span><span class="o">&lt;=</span><span class="n">jmax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">P</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!   ******  insert each element in the list  *********************</span>
<span class="w">         </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jmax</span><span class="w"></span>
<span class="w">            </span><span class="n">newj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ic</span><span class="p">(</span><span class="n">Ja</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">do while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&lt;</span><span class="n">newj</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="n">newj</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">               </span><span class="c">!</span>
<span class="w">               </span><span class="c">!  ** error.. duplicate entry in a</span>
<span class="w">               </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span>
<span class="k">            else</span>
<span class="k">               </span><span class="n">P</span><span class="p">(</span><span class="n">newj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">P</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newj</span><span class="w"></span>
<span class="w">               </span><span class="n">Jar</span><span class="p">(</span><span class="n">newj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ja</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Ar</span><span class="p">(</span><span class="n">newj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!   ******  replace old row in ja and a  *************************</span>
<span class="w">         </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jmax</span><span class="w"></span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">Ja</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Jar</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ar</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      endif</span>
<span class="k">   enddo</span>
<span class="k">   </span><span class="n">Flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="k">end subroutine </span><span class="n">nroc</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>odepack was developed by Alan C. Hindmarsh as modified by John S. Urban, Jacob Williams<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-10-08 11:17            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>