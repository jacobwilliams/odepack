<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="ODEPACK - A Systematized Collection of ODE Solvers">
    <meta name="author" content="Alan C. Hindmarsh as modified by John S. Urban, Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>dlsodi &ndash; odepack</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">odepack </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../sourcefile/m_odepack.f90.html">Source File</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
              
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../sourcefile/m_odepack.f90.html">Source File</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                                       </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>dlsodi
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 5.3% of total for procedures.">553 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/M_odepack.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/m_odepack.f90.html'>M_odepack.f90</a></li>
     <li><a href='../module/m_odepack.html'>M_odepack</a></li>
     <li class="active">dlsodi</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<em>None</em>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine dlsodi(res, adda, jac, Neq, Y, Ydoti, T, Tout, Itol, Rtol, Atol, Itask, Istate, Iopt, Rwork, Lrw, Iwork, Liw, Mf)</h2>
    

    <p>This is the 18 November 2003 version of
 DLSODI: Livermore Solver for Ordinary Differential Equations
         (Implicit form).</p>
<p>This version is in double precision.</p>
<p>DLSODI solves the initial value problem for linearly implicit
 systems of first order ODEs,
     A(t,y) * dy/dt = g(t,y),  where A(t,y) is a square matrix,
 or, in component form,
     ( a   * ( dy / dt ))  + &hellip; +  ( a     * ( dy   / dt ))  =
        i,1      1                     i,NEQ      NEQ</p>
<div class="codehilite"><pre><span></span><code>  =   g ( t, y, y ,..., y    )   ( i = 1,...,NEQ )
       i      1   2       NEQ
</code></pre></div>

<p>If A is singular, this is a differential-algebraic system.</p>
<h2 id="dlsodi-is-a-variant-version-of-the-dlsode-package">DLSODI is a variant version of the DLSODE package.</h2>
<p>Reference:
     Alan C. Hindmarsh,  ODEPACK, A Systematized Collection of ODE
     Solvers, in Scientific Computing, R. S. Stepleman et al. (Eds.),
     North-Holland, Amsterdam, 1983, pp. 55-64.</p>
<hr>
<p>Authors:       Alan C. Hindmarsh and Jeffrey F. Painter
                Center for Applied Scientific Computing, L-561
                Lawrence Livermore National Laboratory
                Livermore, CA 94551</p>
<hr>
<p>Summary of Usage.</p>
<p>Communication between the user and the DLSODI package, for normal
 situations, is summarized here.  This summary describes only a subset
 of the full set of options available.  See the full description for
 details, including optional communication, nonstandard options,
 and instructions for special situations.  See also the example
 problem (with program and output) following this summary.</p>
<p>A. First, provide a subroutine of the form:
               SUBROUTINE RES (NEQ, T, Y, S, R, IRES)
               DOUBLE PRECISION T, Y(<em>), S(</em>), R(*)
 which computes the residual function
     r = g(t,y)  -  A(t,y) * s ,
 as a function of t and the vectors y and s.  (s is an internally
 generated approximation to dy/dt.)  The arrays Y and S are inputs
 to the RES routine and should not be altered.  The residual
 vector is to be stored in the array R.  The argument IRES should be
 ignored for casual use of DLSODI.  (For uses of IRES, see the
 paragraph on RES in the full description below.)</p>
<p>B. Next, decide whether full or banded form is more economical
 for the storage of matrices.  DLSODI must deal internally with the
 matrices A and dr/dy, where r is the residual function defined above.
 DLSODI generates a linear combination of these two matrices, and
 this is treated in either full or banded form.
     The matrix structure is communicated by a method flag MF,
 which is 21 or 22 for the full case, and 24 or 25 in the band case.
     In the banded case, DLSODI requires two half-bandwidth
 parameters ML and MU.  These are, respectively, the widths of the
 lower and upper parts of the band, excluding the main diagonal.
 Thus the band consists of the locations (i,j) with
 i-ML .le. j .le. i+MU, and the full bandwidth is ML+MU+1.
 Note that the band must accommodate the nonzero elements of
 A(t,y), dg/dy, and d(A*s)/dy (s fixed).  Alternatively, one
 can define a band that encloses only the elements that are relatively
 large in magnitude, and gain some economy in storage and possibly
 also efficiency, although the appropriate threshhold for
 retaining matrix elements is highly problem-dependent.</p>
<p>C. You must also provide a subroutine of the form:
               SUBROUTINE ADDA (NEQ, T, Y, ML, MU, P, NROWP)
               DOUBLE PRECISION T, Y(<em>), P(NROWP,</em>)
 which adds the matrix A = A(t,y) to the contents of the array P.
 T and the Y array are input and should not be altered.
     In the full matrix case, this routine should add elements of
 to P in the usual order.  I.e., add A(i,j) to P(i,j).  (Ignore the
 ML and MU arguments in this case.)
     In the band matrix case, this routine should add element A(i,j)
 to P(i-j+MU+1,j).  I.e., add the diagonal lines of A to the rows of
 P from the top down (the top line of A added to the first row of P).</p>
<p>D. For the sake of efficiency, you are encouraged to supply the
 Jacobian matrix dr/dy in closed form, where r = g(t,y) - A(t,y)<em>s
 (s = a fixed vector) as above.  If dr/dy is being supplied,
 use MF = 21 or 24, and provide a subroutine of the form:
               SUBROUTINE JAC (NEQ, T, Y, S, ML, MU, P, NROWP)
               DOUBLE PRECISION T, Y(</em>), S(<em>), P(NROWP,</em>)
 which computes dr/dy as a function of t, y, and s.  Here T, Y, and
 S are inputs, and the routine is to load dr/dy into P as follows:
     In the full matrix case (MF = 21), load P(i,j) with dr(i)/dy(j),
 the partial derivative of r(i) with respect to y(j).  (Ignore the
 ML and MU arguments in this case.)
     In the band matrix case (MF = 24), load P(i-j+mu+1,j) with
 dr(i)/dy(j), i.e. load the diagonal lines of dr/dy into the rows of
 P from the top down.
     In either case, only nonzero elements need be loaded, and the
 indexing of P is the same as in the ADDA routine.
     Note that if A is independent of y (or this dependence
 is weak enough to be ignored) then JAC is to compute dg/dy.
     If it is not feasible to provide a JAC routine, use
 MF = 22 or 25, and DLSODI will compute an approximate Jacobian
 internally by difference quotients.</p>
<p>E. Next decide whether or not to provide the initial value of the
 derivative vector dy/dt.  If the initial value of A(t,y) is
 nonsingular (and not too ill-conditioned), you may let DLSODI compute
 this vector (ISTATE = 0).  (DLSODI will solve the system A<em>s = g for
 s, with initial values of A and g.)  If A(t,y) is initially
 singular, then the system is a differential-algebraic system, and
 you must make use of the particular form of the system to compute the
 initial values of y and dy/dt.  In that case, use ISTATE = 1 and
 load the initial value of dy/dt into the array YDOTI.
 The input array YDOTI and the initial Y array must be consistent with
 the equations A</em>dy/dt = g.  This implies that the initial residual
 r = g(t,y) - A(t,y)*YDOTI  must be approximately zero.</p>
<p>F. Write a main program which calls Subroutine DLSODI once for
 each point at which answers are desired.  This should also provide
 for possible use of logical unit 6 for output of error messages
 by DLSODI.  On the first call to DLSODI, supply arguments as follows:
 RES    = name of user subroutine for residual function r.
 ADDA   = name of user subroutine for computing and adding A(t,y).
 JAC    = name of user subroutine for Jacobian matrix dr/dy
          (MF = 21 or 24).  If not used, pass a dummy name.
 Note: the names for the RES and ADDA routines and (if used) the
        JAC routine must be declared External in the calling program.
 NEQ    = number of scalar equations in the system.
 Y      = array of initial values, of length NEQ.
 YDOTI  = array of length NEQ (containing initial dy/dt if ISTATE = 1).
 T      = the initial value of the independent variable.
 TOUT   = first point where output is desired (.ne. T).
 ITOL   = 1 or 2 according as ATOL (below) is a scalar or array.
 RTOL   = relative tolerance parameter (scalar).
 ATOL   = absolute tolerance parameter (scalar or array).
          the estimated local error in y(i) will be controlled so as
          to be roughly less (in magnitude) than
             EWT(i) = RTOL<em>ABS(Y(i)) + ATOL     if ITOL = 1, or
             EWT(i) = RTOL</em>ABS(Y(i)) + ATOL(i)  if ITOL = 2.
          Thus the local error test passes if, in each component,
          either the absolute error is less than ATOL (or ATOL(i)),
          or the relative error is less than RTOL.
          Use RTOL = 0.0 for pure absolute error control, and
          use ATOL = 0.0 (or ATOL(i) = 0.0) for pure relative error
          control.  Caution: Actual (global) errors may exceed these
          local tolerances, so choose them conservatively.
 ITASK  = 1 for normal computation of output values of y at t = TOUT.
 ISTATE = integer flag (input and output).  Set ISTATE = 1 if the
          initial dy/dt is supplied, and 0 otherwise.
 IOPT   = 0 to indicate no optional inputs used.
 RWORK  = real work array of length at least:
             22 +  9<em>NEQ + NEQ</em><em>2           for MF = 21 or 22,
             22 + 10</em>NEQ + (2<em>ML + MU)</em>NEQ  for MF = 24 or 25.
 LRW    = declared length of RWORK (in user&rsquo;s dimension).
 IWORK  = integer work array of length at least 20 + NEQ.
          If MF = 24 or 25, input in IWORK(1),IWORK(2) the lower
          and upper half-bandwidths ML,MU.
 LIW    = declared length of IWORK (in user&rsquo;s dimension).
 MF     = method flag.  Standard values are:
          21 for a user-supplied full Jacobian.
          22 for an internally generated full Jacobian.
          24 for a user-supplied banded Jacobian.
          25 for an internally generated banded Jacobian.
          for other choices of MF, see the paragraph on MF in
          the full description below.
 Note that the main program must declare arrays Y, YDOTI, RWORK, IWORK,
 and possibly ATOL.</p>
<p>G. The output from the first call (or any call) is:
      Y = array of computed values of y(t) vector.
      T = corresponding value of independent variable (normally TOUT).
 ISTATE = 2  if DLSODI was successful, negative otherwise.
          -1 means excess work done on this call (check all inputs).
          -2 means excess accuracy requested (tolerances too small).
          -3 means illegal input detected (see printed message).
          -4 means repeated error test failures (check all inputs).
          -5 means repeated convergence failures (perhaps bad Jacobian
             supplied or wrong choice of tolerances).
          -6 means error weight became zero during problem. (Solution
             component i vanished, and ATOL or ATOL(i) = 0.)
          -7 cannot occur in casual use.
          -8 means DLSODI was unable to compute the initial dy/dt.
             In casual use, this means A(t,y) is initially singular.
             Supply YDOTI and use ISTATE = 1 on the first call.</p>
<p>If DLSODI returns ISTATE = -1, -4, or -5, then the output of
  DLSODI also includes YDOTI = array containing residual vector
  r = g - A * dy/dt  evaluated at the current t, y, and dy/dt.</p>
<p>H. To continue the integration after a successful return, simply
 reset TOUT and call DLSODI again.  No other parameters need be reset.</p>
<hr>
<p>Example Problem.</p>
<p>The following is a simple example problem, with the coding
 needed for its solution by DLSODI.  The problem is from chemical
 kinetics, and consists of the following three equations:
     dy1/dt = -.04<em>y1 + 1.e4</em>y2<em>y3
     dy2/dt = .04</em>y1 - 1.e4<em>y2</em>y3 - 3.e7<em>y2</em>*2
       0.   = y1 + y2 + y3 - 1.
 on the interval from t = 0.0 to t = 4.e10, with initial conditions
 y1 = 1.0, y2 = y3 = 0.</p>
<p>The following coding solves this problem with DLSODI, using MF = 21
 and printing results at t = .4, 4., &hellip;, 4.e10.  It uses
 ITOL = 2 and ATOL much smaller for y2 than y1 or y3 because
 y2 has much smaller values.  dy/dt is supplied in YDOTI. We had
 obtained the initial value of dy3/dt by differentiating the
 third equation and evaluating the first two at t = 0.
 At the end of the run, statistical quantities of interest are
 printed (see optional outputs in the full description below).</p>
<div class="codehilite"><pre><span></span><code><span class="k">program </span><span class="n">dlsodi_ex</span><span class="w"></span>
<span class="k">use </span><span class="n">m_odepack</span><span class="w"></span>
<span class="k">implicit none</span>
<span class="k">external </span><span class="n">aplusp</span><span class="w"></span>
<span class="k">external </span><span class="n">dgbydy</span><span class="w"></span>
<span class="k">external </span><span class="n">resid</span><span class="w"></span>

<span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w">            </span><span class="kd">::</span><span class="w">  </span><span class="n">dp</span><span class="o">=</span><span class="nb">kind</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">)</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w">  </span><span class="n">atol</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ydoti</span><span class="w"></span>
<span class="kt">integer</span><span class="w">                      </span><span class="kd">::</span><span class="w">  </span><span class="n">iopt</span><span class="p">,</span><span class="n">iout</span><span class="p">,</span><span class="n">istate</span><span class="p">,</span><span class="n">itask</span><span class="p">,</span><span class="n">itol</span><span class="p">,</span><span class="n">liw</span><span class="p">,</span><span class="n">lrw</span><span class="p">,</span><span class="n">mf</span><span class="p">,</span><span class="n">neq</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w">  </span><span class="n">iwork</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w">                </span><span class="kd">::</span><span class="w">  </span><span class="n">rtol</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">tout</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">58</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w">  </span><span class="n">rwork</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">reference</span><span class="p">()</span><span class="w"></span>

<span class="w">   </span><span class="n">neq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">   </span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="w"></span>
<span class="w">   </span><span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="w">   </span><span class="n">y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="w">   </span><span class="n">ydoti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">.</span><span class="mi">04</span><span class="w"></span>
<span class="w">   </span><span class="n">ydoti</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="mi">04</span><span class="w"></span>
<span class="w">   </span><span class="n">ydoti</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="w">   </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="w">   </span><span class="n">tout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="mi">4</span><span class="w"></span>
<span class="w">   </span><span class="n">itol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">   </span><span class="n">rtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.D-4</span><span class="w"></span>
<span class="w">   </span><span class="n">atol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.D-6</span><span class="w"></span>
<span class="w">   </span><span class="n">atol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.D-10</span><span class="w"></span>
<span class="w">   </span><span class="n">atol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.D-6</span><span class="w"></span>
<span class="w">   </span><span class="n">itask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">   </span><span class="n">istate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">   </span><span class="n">iopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">lrw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">58</span><span class="w"></span>
<span class="w">   </span><span class="n">liw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">23</span><span class="w"></span>
<span class="w">   </span><span class="n">mf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">21</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">iout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">dlsodi</span><span class="p">(</span><span class="n">resid</span><span class="p">,</span><span class="n">aplusp</span><span class="p">,</span><span class="n">dgbydy</span><span class="p">,[</span><span class="n">neq</span><span class="p">],</span><span class="n">y</span><span class="p">,</span><span class="n">ydoti</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">tout</span><span class="p">,</span><span class="n">itol</span><span class="p">,[</span><span class="n">rtol</span><span class="p">],</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                </span><span class="p">&amp;</span><span class="w"> </span><span class="n">atol</span><span class="p">,</span><span class="n">itask</span><span class="p">,</span><span class="n">istate</span><span class="p">,</span><span class="n">iopt</span><span class="p">,</span><span class="n">rwork</span><span class="p">,</span><span class="n">lrw</span><span class="p">,</span><span class="n">iwork</span><span class="p">,</span><span class="n">liw</span><span class="p">,</span><span class="n">mf</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">99010</span><span class="p">)</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="mi">99010</span><span class="w"> </span><span class="k">format</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39; At t =&#39;</span><span class="p">,</span><span class="n">d12</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;   Y =&#39;</span><span class="p">,</span><span class="mi">3</span><span class="n">D14</span><span class="p">.</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">istate</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         write</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">99020</span><span class="p">)</span><span class="w"> </span><span class="n">istate</span><span class="w"></span>
<span class="w">   </span><span class="mi">99020</span><span class="w"> </span><span class="k">format</span><span class="w"> </span><span class="p">(</span><span class="o">///</span><span class="s1">&#39; Error halt.. ISTATE =&#39;</span><span class="p">,</span><span class="n">i3</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">stop </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span>
<span class="k">         </span><span class="n">tout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tout</span><span class="o">*</span><span class="mi">1</span><span class="mf">0.</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">   enddo</span>
<span class="k">   write</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">99030</span><span class="p">)</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">iwork</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">iwork</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="mi">99030</span><span class="w"> </span><span class="k">format</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="s1">&#39; No. steps =&#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">,</span><span class="s1">&#39;  No. r-s =&#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">,</span><span class="s1">&#39;  No. J-s =&#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">)</span><span class="w"></span>

<span class="k">end program </span><span class="n">dlsodi_ex</span><span class="w"></span>

<span class="k">subroutine </span><span class="n">resid</span><span class="p">(</span><span class="n">Neq</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Ires</span><span class="p">)</span><span class="w"></span>
<span class="k">implicit none</span>
<span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dp</span><span class="o">=</span><span class="nb">kind</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">)</span><span class="w"></span>

<span class="kt">integer</span><span class="w">                                 </span><span class="kd">::</span><span class="w">  </span><span class="n">Neq</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w">                           </span><span class="kd">::</span><span class="w">  </span><span class="n">T</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w">  </span><span class="n">Y</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w">  </span><span class="n">S</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w">  </span><span class="n">R</span><span class="w"></span>
<span class="kt">integer</span><span class="w">                                 </span><span class="kd">::</span><span class="w">  </span><span class="n">Ires</span><span class="w"></span>

<span class="w">   </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">.</span><span class="mi">04</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.D4</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="mi">04</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.D4</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">3.D7</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.</span><span class="w"></span>
<span class="k">end subroutine </span><span class="n">resid</span><span class="w"></span>

<span class="k">subroutine </span><span class="n">aplusp</span><span class="p">(</span><span class="n">Neq</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Ml</span><span class="p">,</span><span class="n">Mu</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Nrowp</span><span class="p">)</span><span class="w"></span>
<span class="k">implicit none</span>
<span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dp</span><span class="o">=</span><span class="nb">kind</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">)</span><span class="w"></span>

<span class="kt">integer</span><span class="w">                                         </span><span class="kd">::</span><span class="w">  </span><span class="n">Neq</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w">                                   </span><span class="kd">::</span><span class="w">  </span><span class="n">T</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">                      </span><span class="kd">::</span><span class="w">  </span><span class="n">Y</span><span class="w"></span>
<span class="kt">integer</span><span class="w">                                         </span><span class="kd">::</span><span class="w">  </span><span class="n">Ml</span><span class="w"></span>
<span class="kt">integer</span><span class="w">                                         </span><span class="kd">::</span><span class="w">  </span><span class="n">Mu</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">Nrowp</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w">  </span><span class="n">P</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                              </span><span class="kd">::</span><span class="w">  </span><span class="n">Nrowp</span><span class="w"></span>

<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.</span><span class="w"></span>
<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.</span><span class="w"></span>
<span class="k">end subroutine </span><span class="n">aplusp</span><span class="w"></span>

<span class="k">subroutine </span><span class="n">dgbydy</span><span class="p">(</span><span class="n">Neq</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Ml</span><span class="p">,</span><span class="n">Mu</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Nrowp</span><span class="p">)</span><span class="w"></span>
<span class="k">implicit none</span>
<span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w">                             </span><span class="kd">::</span><span class="w">  </span><span class="n">dp</span><span class="o">=</span><span class="nb">kind</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">)</span><span class="w"></span>
<span class="kt">integer</span><span class="w">                                       </span><span class="kd">::</span><span class="w">  </span><span class="n">Neq</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w">                                 </span><span class="kd">::</span><span class="w">  </span><span class="n">T</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w">  </span><span class="n">Y</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">                    </span><span class="kd">::</span><span class="w">  </span><span class="n">S</span><span class="w"></span>
<span class="kt">integer</span><span class="w">                                       </span><span class="kd">::</span><span class="w">  </span><span class="n">Ml</span><span class="w"></span>
<span class="kt">integer</span><span class="w">                                       </span><span class="kd">::</span><span class="w">  </span><span class="n">Mu</span><span class="w"></span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">Nrowp</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w">  </span><span class="n">P</span><span class="w"></span>
<span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                            </span><span class="kd">::</span><span class="w">  </span><span class="n">Nrowp</span><span class="w"></span>

<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">.</span><span class="mi">04</span><span class="w"></span>
<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.D4</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.D4</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="mi">04</span><span class="w"></span>
<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.D4</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">6.D7</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.D4</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="w"></span>
<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="w"></span>
<span class="w">   </span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="w"></span>
<span class="k">end subroutine </span><span class="n">dgbydy</span><span class="w"></span>
</code></pre></div>

<p>The output of this program (on a CDC-7600 in single precision)
 is as follows:</p>
<p>At t =  4.0000e-01   Y =  9.851726e-01  3.386406e-05  1.479357e-02
   At t =  4.0000e+00   Y =  9.055142e-01  2.240418e-05  9.446344e-02
   At t =  4.0000e+01   Y =  7.158050e-01  9.184616e-06  2.841858e-01
   At t =  4.0000e+02   Y =  4.504846e-01  3.222434e-06  5.495122e-01
   At t =  4.0000e+03   Y =  1.831701e-01  8.940379e-07  8.168290e-01
   At t =  4.0000e+04   Y =  3.897016e-02  1.621193e-07  9.610297e-01
   At t =  4.0000e+05   Y =  4.935213e-03  1.983756e-08  9.950648e-01
   At t =  4.0000e+06   Y =  5.159269e-04  2.064759e-09  9.994841e-01
   At t =  4.0000e+07   Y =  5.306413e-05  2.122677e-10  9.999469e-01
   At t =  4.0000e+08   Y =  5.494532e-06  2.197826e-11  9.999945e-01
   At t =  4.0000e+09   Y =  5.129457e-07  2.051784e-12  9.999995e-01
   At t =  4.0000e+10   Y = -7.170472e-08 -2.868188e-13  1.000000e+00</p>
<p>No. steps = 330  No. r-s = 404  No. J-s =  69</p>
<hr>
<p>Full Description of User Interface to DLSODI.</p>
<p>The user interface to DLSODI consists of the following parts.</p>
<ol>
<li>
<p>The call sequence to Subroutine DLSODI, which is a driver
      routine for the solver.  This includes descriptions of both
      the call sequence arguments and of user-supplied routines.
      Following these descriptions is a description of
      optional inputs available through the call sequence, and then
      a description of optional outputs (in the work arrays).</p>
</li>
<li>
<p>Descriptions of other routines in the DLSODI package that may be
      (optionally) called by the user.  These provide the ability to
      alter error message handling, save and restore the internal
      Common, and obtain specified derivatives of the solution y(t).</p>
</li>
<li>
<p>Descriptions of Common blocks to be declared in overlay
      or similar environments, or to be saved when doing an interrupt
      of the problem and continued solution later.</p>
</li>
<li>
<p>Description of two routines in the DLSODI package, either of
      which the user may replace with his/her own version, if desired.
      These relate to the measurement of errors.</p>
</li>
</ol>
<hr>
<p>Part 1.  Call Sequence.</p>
<p>The call sequence parameters used for input only are
     RES, ADDA, JAC, NEQ, TOUT, ITOL, RTOL, ATOL, ITASK,
     IOPT, LRW, LIW, MF,
 and those used for both input and output are
     Y, T, ISTATE, YDOTI.
 The work arrays RWORK and IWORK are also used for conditional and
 optional inputs and optional outputs.  (The term output here refers
 to the return from Subroutine DLSODI to the user&rsquo;s calling program.)</p>
<p>The legality of input parameters will be thoroughly checked on the
 initial call for the problem, but not checked thereafter unless a
 change in input parameters is flagged by ISTATE = 3 on input.</p>
<p>The descriptions of the call arguments are as follows.</p>
<p>RES    = the name of the user-supplied subroutine which supplies
          the residual vector for the ODE system, defined by
            r = g(t,y) - A(t,y) * s
          as a function of the scalar t and the vectors
          s and y (s approximates dy/dt).  This subroutine
          is to have the form
               SUBROUTINE RES (NEQ, T, Y, S, R, IRES)
               DOUBLE PRECISION T, Y(<em>), S(</em>), R(<em>)
          where NEQ, T, Y, S, and IRES are input, and R and
          IRES are output.  Y, S, and R are arrays of length NEQ.
             On input, IRES indicates how DLSODI will use the
          returned array R, as follows:
             IRES = 1  means that DLSODI needs the full residual,
                       r = g - A</em>s, exactly.
             IRES = -1 means that DLSODI is using R only to compute
                       the Jacobian dr/dy by difference quotients.
          The RES routine can ignore IRES, or it can omit some terms
          if IRES = -1.  If A does not depend on y, then RES can
          just return R = g when IRES = -1.  If g - A*s contains other
          additive terms that are independent of y, these can also be
          dropped, if done consistently, when IRES = -1.
             The subroutine should set the flag IRES if it
          encounters a halt condition or illegal input.
          Otherwise, it should not reset IRES.  On output,
             IRES = 1 or -1 represents a normal return, and
          DLSODI continues integrating the ODE.  Leave IRES
          unchanged from its input value.
             IRES = 2 tells DLSODI to immediately return control
          to the calling program, with ISTATE = 3.  This lets
          the calling program change parameters of the problem,
          if necessary.
             IRES = 3 represents an error condition (for example, an
          illegal value of y).  DLSODI tries to integrate the system
          without getting IRES = 3 from RES.  If it cannot, DLSODI
          returns with ISTATE = -7 or -1.
             On an DLSODI return with ISTATE = 3, -1, or -7, the values
          of T and Y returned correspond to the last point reached
          successfully without getting the flag IRES = 2 or 3.
             The flag values IRES = 2 and 3 should not be used to
          handle switches or root-stop conditions.  This is better
          done by calling DLSODI in a one-step mode and checking the
          stopping function for a sign change at each step.
             If quantities computed in the RES routine are needed
          externally to DLSODI, an extra call to RES should be made
          for this purpose, for consistent and accurate results.
          To get the current dy/dt for the S argument, use DINTDY.
             RES must be declared External in the calling
          program.  See note below for more about RES.</p>
<p>ADDA   = the name of the user-supplied subroutine which adds the
          matrix A = A(t,y) to another matrix stored in the same form
          as A.  The storage form is determined by MITER (see MF).
          This subroutine is to have the form
               SUBROUTINE ADDA (NEQ, T, Y, ML, MU, P, NROWP)
               DOUBLE PRECISION T, Y(<em>), P(NROWP,</em>)
          where NEQ, T, Y, ML, MU, and NROWP are input and P is
          output.  Y is an array of length NEQ, and the matrix P is
          stored in an NROWP by NEQ array.
             In the full matrix case ( MITER = 1 or 2) ADDA should
          add  A    to P(i,j).  ML and MU are ignored.
                i,j
             In the band matrix case ( MITER = 4 or 5) ADDA should
          add  A    to  P(i-j+MU+1,j).
                i,j
          See JAC for details on this band storage form.
             ADDA must be declared External in the calling program.
          See note below for more information about ADDA.</p>
<p>JAC    = the name of the user-supplied subroutine which supplies the
          Jacobian matrix, dr/dy, where r = g - A<em>s.  The form of the
          Jacobian matrix is determined by MITER.  JAC is required
          if MITER = 1 or 4 &ndash; otherwise a dummy name can be
          passed.  This subroutine is to have the form
               SUBROUTINE JAC ( NEQ, T, Y, S, ML, MU, P, NROWP )
               DOUBLE PRECISION T, Y(</em>), S(<em>), P(NROWP,</em>)
          where NEQ, T, Y, S, ML, MU, and NROWP are input and P
          is output.  Y and S are arrays of length NEQ, and the
          matrix P is stored in an NROWP by NEQ array.
          P is to be loaded with partial derivatives (elements
          of the Jacobian matrix) on output.
             In the full matrix case (MITER = 1), ML and MU
          are ignored and the Jacobian is to be loaded into P
          by columns&ndash; i.e., dr(i)/dy(j) is loaded into P(i,j).
             In the band matrix case (MITER = 4), the elements
          within the band are to be loaded into P by columns,
          with diagonal lines of dr/dy loaded into the
          rows of P.  Thus dr(i)/dy(j) is to be loaded
          into P(i-j+MU+1,j).  The locations in P in the two
          triangular areas which correspond to nonexistent matrix
          elements can be ignored or loaded arbitrarily, as they
          they are overwritten by DLSODI.  ML and MU are the
          half-bandwidth parameters (see IWORK).
               In either case, P is preset to zero by the solver,
          so that only the nonzero elements need be loaded by JAC.
          Each call to JAC is preceded by a call to RES with the same
          arguments NEQ, T, Y, and S.  Thus to gain some efficiency,
          intermediate quantities shared by both calculations may be
          saved in a user Common block by RES and not recomputed by JAC
          if desired.  Also, JAC may alter the Y array, if desired.
               JAC need not provide dr/dy exactly.  A crude
          approximation (possibly with a smaller bandwidth) will do.
               JAC must be declared External in the calling program.
               See note below for more about JAC.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Note</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">RES</span><span class="p">,</span><span class="w"> </span><span class="n">ADDA</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">JAC</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="n">These</span><span class="w"> </span><span class="n">subroutines</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">defined</span><span class="w"> </span><span class="n">quantities</span><span class="w"> </span><span class="ow">in</span><span class="w"></span>
<span class="w">      </span><span class="n">NEQ</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">...</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="n">NEQ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="o">...</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">NEQ</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">array</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="n">dimensioned</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subroutines</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">length</span><span class="w"></span>
<span class="w">      </span><span class="n">exceeding</span><span class="w"> </span><span class="n">NEQ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="w">  </span><span class="n">However</span><span class="p">,</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">routines</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">alter</span><span class="w"></span>
<span class="w">      </span><span class="n">NEQ</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">...</span><span class="p">,</span><span class="n">Y</span><span class="p">(</span><span class="n">NEQ</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="n">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">descriptions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">NEQ</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="w"></span>
</code></pre></div>

<p>NEQ    = the size of the system (number of first order ordinary
          differential equations or scalar algebraic equations).
          Used only for input.
          NEQ may be decreased, but not increased, during the problem.
          If NEQ is decreased (with ISTATE = 3 on input), the
          remaining components of Y should be left undisturbed, if
          these are to be accessed in RES, ADDA, or JAC.</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">Normally</span>, <span class="nv">NEQ</span> <span class="nv">is</span> <span class="nv">a</span> <span class="nv">scalar</span>, <span class="nv">and</span> <span class="nv">it</span> <span class="nv">is</span> <span class="nv">generally</span> <span class="nv">referred</span> <span class="nv">to</span>
      <span class="nv">as</span> <span class="nv">a</span> <span class="nv">scalar</span> <span class="nv">in</span> <span class="nv">this</span> <span class="nv">user</span> <span class="nv">interface</span> <span class="nv">description</span>.  <span class="nv">However</span>,
      <span class="nv">NEQ</span> <span class="nv">may</span> <span class="nv">be</span> <span class="nv">an</span> <span class="nv">array</span>, <span class="nv">with</span> <span class="nv">NEQ</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span> <span class="nv">set</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">system</span> <span class="nv">size</span>.
      <span class="ss">(</span><span class="nv">The</span> <span class="nv">DLSODI</span> <span class="nv">package</span> <span class="nv">accesses</span> <span class="nv">only</span> <span class="nv">NEQ</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span>.<span class="ss">)</span>  <span class="nv">In</span> <span class="nv">either</span> <span class="nv">case</span>,
      <span class="nv">this</span> <span class="nv">parameter</span> <span class="nv">is</span> <span class="nv">passed</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">NEQ</span> <span class="nv">argument</span> <span class="nv">in</span> <span class="nv">all</span> <span class="nv">calls</span>
      <span class="nv">to</span> <span class="nv">RES</span>, <span class="nv">ADDA</span>, <span class="nv">and</span> <span class="nv">JAC</span>.  <span class="nv">Hence</span>, <span class="k">if</span> <span class="nv">it</span> <span class="nv">is</span> <span class="nv">an</span> <span class="nv">array</span>,
      <span class="nv">locations</span> <span class="nv">NEQ</span><span class="ss">(</span><span class="mi">2</span><span class="ss">)</span>,... <span class="nv">may</span> <span class="nv">be</span> <span class="nv">used</span> <span class="nv">to</span> <span class="nv">store</span> <span class="nv">other</span> <span class="nv">integer</span> <span class="nv">data</span>
      <span class="nv">and</span> <span class="nv">pass</span> <span class="nv">it</span> <span class="nv">to</span> <span class="nv">RES</span>, <span class="nv">ADDA</span>, <span class="nv">or</span> <span class="nv">JAC</span>.  <span class="nv">Each</span> <span class="nv">such</span> <span class="nv">subroutine</span>
      <span class="nv">must</span> <span class="k">include</span> <span class="nv">NEQ</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">Dimension</span> <span class="nv">statement</span> <span class="nv">in</span> <span class="nv">that</span> <span class="nv">case</span>.
</code></pre></div>

<p>Y      = a real array for the vector of dependent variables, of
          length NEQ or more.  Used for both input and output on the
          first call (ISTATE = 0 or 1), and only for output on other
          calls.  On the first call, Y must contain the vector of
          initial values.  On output, Y contains the computed solution
          vector, evaluated at T.  If desired, the Y array may be used
          for other purposes between calls to the solver.</p>
<div class="codehilite"><pre><span></span><code>      This array is passed as the Y argument in all calls to RES,
      ADDA, and JAC.  Hence its length may exceed NEQ,
      and locations Y(NEQ+1),... may be used to store other real
      data and pass it to RES, ADDA, or JAC.  (The DLSODI
      package accesses only Y(1),...,Y(NEQ). )
</code></pre></div>

<p>YDOTI  = a real array for the initial value of the vector
          dy/dt and for work space, of dimension at least NEQ.</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">On</span> <span class="nv">input</span>:
        <span class="k">If</span> <span class="nv">ISTATE</span> <span class="o">=</span> <span class="mi">0</span>, <span class="k">then</span> <span class="nv">DLSODI</span> <span class="nv">will</span> <span class="nv">compute</span> <span class="nv">the</span> <span class="nv">initial</span> <span class="nv">value</span>
      <span class="nv">of</span> <span class="nv">dy</span><span class="o">/</span><span class="nv">dt</span>, <span class="k">if</span> <span class="nv">A</span> <span class="nv">is</span> <span class="nv">nonsingular</span>.  <span class="nv">Thus</span> <span class="nv">YDOTI</span> <span class="nv">will</span>
      <span class="nv">serve</span> <span class="nv">only</span> <span class="nv">as</span> <span class="nv">work</span> <span class="nv">space</span> <span class="nv">and</span> <span class="nv">may</span> <span class="nv">have</span> <span class="nv">any</span> <span class="nv">value</span>.
        <span class="k">If</span> <span class="nv">ISTATE</span> <span class="o">=</span> <span class="mi">1</span>, <span class="k">then</span> <span class="nv">YDOTI</span> <span class="nv">must</span> <span class="nv">contain</span> <span class="nv">the</span> <span class="nv">initial</span> <span class="nv">value</span>
      <span class="nv">of</span> <span class="nv">dy</span><span class="o">/</span><span class="nv">dt</span>.
        <span class="k">If</span> <span class="nv">ISTATE</span> <span class="o">=</span> <span class="mi">2</span> <span class="nv">or</span> <span class="mi">3</span> <span class="ss">(</span><span class="nv">continuation</span> <span class="nv">calls</span><span class="ss">)</span>, <span class="k">then</span> <span class="nv">YDOTI</span>
      <span class="nv">may</span> <span class="nv">have</span> <span class="nv">any</span> <span class="nv">value</span>.
        <span class="nv">Note</span>: <span class="k">If</span> <span class="nv">the</span> <span class="nv">initial</span> <span class="nv">value</span> <span class="nv">of</span> <span class="nv">A</span> <span class="nv">is</span> <span class="nv">singular</span>, <span class="k">then</span>
      <span class="nv">DLSODI</span> <span class="nv">cannot</span> <span class="nv">compute</span> <span class="nv">the</span> <span class="nv">initial</span> <span class="nv">value</span> <span class="nv">of</span> <span class="nv">dy</span><span class="o">/</span><span class="nv">dt</span>, <span class="nv">so</span>
      <span class="nv">it</span> <span class="nv">must</span> <span class="nv">be</span> <span class="nv">provided</span> <span class="nv">in</span> <span class="nv">YDOTI</span>, <span class="nv">with</span> <span class="nv">ISTATE</span> <span class="o">=</span> <span class="mi">1</span>.

      <span class="nv">On</span> <span class="nv">output</span>, <span class="nv">when</span> <span class="nv">DLSODI</span> <span class="nv">terminates</span> <span class="nv">abnormally</span> <span class="nv">with</span> <span class="nv">ISTATE</span> <span class="o">=</span>
      <span class="o">-</span><span class="mi">1</span>, <span class="o">-</span><span class="mi">4</span>, <span class="nv">or</span> <span class="o">-</span><span class="mi">5</span>, <span class="nv">YDOTI</span> <span class="nv">will</span> <span class="nv">contain</span> <span class="nv">the</span> <span class="nv">residual</span>
      <span class="nv">r</span> <span class="o">=</span> <span class="nv">g</span><span class="ss">(</span><span class="nv">t</span>,<span class="nv">y</span><span class="ss">)</span> <span class="o">-</span> <span class="nv">A</span><span class="ss">(</span><span class="nv">t</span>,<span class="nv">y</span><span class="ss">)</span><span class="o">*</span><span class="ss">(</span><span class="nv">dy</span><span class="o">/</span><span class="nv">dt</span><span class="ss">)</span>.  <span class="k">If</span> <span class="nv">r</span> <span class="nv">is</span> <span class="nv">large</span>, <span class="nv">t</span> <span class="nv">is</span> <span class="nv">near</span>
      <span class="nv">its</span> <span class="nv">initial</span> <span class="nv">value</span>, <span class="nv">and</span> <span class="nv">YDOTI</span> <span class="nv">is</span> <span class="nv">supplied</span> <span class="nv">with</span> <span class="nv">ISTATE</span> <span class="o">=</span> <span class="mi">1</span>,
      <span class="k">then</span> <span class="nv">there</span> <span class="nv">may</span> <span class="nv">have</span> <span class="nv">been</span> <span class="nv">an</span> <span class="nv">incorrect</span> <span class="nv">input</span> <span class="nv">value</span> <span class="nv">of</span>
      <span class="nv">YDOTI</span> <span class="o">=</span> <span class="nv">dy</span><span class="o">/</span><span class="nv">dt</span>, <span class="nv">or</span> <span class="nv">the</span> <span class="nv">problem</span> <span class="ss">(</span><span class="nv">as</span> <span class="nv">given</span> <span class="nv">to</span> <span class="nv">DLSODI</span><span class="ss">)</span>
      <span class="nv">may</span> <span class="nv">not</span> <span class="nv">have</span> <span class="nv">a</span> <span class="nv">solution</span>.

      <span class="k">If</span> <span class="nv">desired</span>, <span class="nv">the</span> <span class="nv">YDOTI</span> <span class="nv">array</span> <span class="nv">may</span> <span class="nv">be</span> <span class="nv">used</span> <span class="k">for</span> <span class="nv">other</span>
      <span class="nv">purposes</span> <span class="nv">between</span> <span class="nv">calls</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">solver</span>.
</code></pre></div>

<p>T      = the independent variable.  On input, T is used only on the
          first call, as the initial point of the integration.
          On output, after each call, T is the value at which a
          computed solution Y is evaluated (usually the same as TOUT).
          on an error return, T is the farthest point reached.</p>
<p>TOUT   = the next value of t at which a computed solution is desired.
          Used only for input.</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">When</span> <span class="nv">starting</span> <span class="nv">the</span> <span class="nv">problem</span> <span class="ss">(</span><span class="nv">ISTATE</span> <span class="o">=</span> <span class="mi">0</span> <span class="nv">or</span> <span class="mi">1</span><span class="ss">)</span>, <span class="nv">TOUT</span> <span class="nv">may</span> <span class="nv">be</span>
      <span class="nv">equal</span> <span class="nv">to</span> <span class="nv">T</span> <span class="k">for</span> <span class="nv">one</span> <span class="nv">call</span>, <span class="k">then</span> <span class="nv">should</span> .<span class="nv">ne</span>. <span class="nv">T</span> <span class="k">for</span> <span class="nv">the</span> <span class="k">next</span>
      <span class="nv">call</span>.  <span class="k">For</span> <span class="nv">the</span> <span class="nv">initial</span> <span class="nv">T</span>, <span class="nv">an</span> <span class="nv">input</span> <span class="nv">value</span> <span class="nv">of</span> <span class="nv">TOUT</span> .<span class="nv">ne</span>. <span class="nv">T</span> <span class="nv">is</span>
      <span class="nv">used</span> <span class="nv">in</span> <span class="nv">order</span> <span class="nv">to</span> <span class="nv">determine</span> <span class="nv">the</span> <span class="nv">direction</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">integration</span>
      <span class="ss">(</span><span class="nv">i</span>.<span class="nv">e</span>. <span class="nv">the</span> <span class="nv">algebraic</span> <span class="nv">sign</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">step</span> <span class="nv">sizes</span><span class="ss">)</span> <span class="nv">and</span> <span class="nv">the</span> <span class="nv">rough</span>
      <span class="nv">scale</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">problem</span>.  <span class="nv">Integration</span> <span class="nv">in</span> <span class="nv">either</span> <span class="nv">direction</span>
      <span class="ss">(</span><span class="nv">forward</span> <span class="nv">or</span> <span class="nv">backward</span> <span class="nv">in</span> <span class="nv">t</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">permitted</span>.

      <span class="k">If</span> <span class="nv">ITASK</span> <span class="o">=</span> <span class="mi">2</span> <span class="nv">or</span> <span class="mi">5</span> <span class="ss">(</span><span class="nv">one</span><span class="o">-</span><span class="nv">step</span> <span class="nv">modes</span><span class="ss">)</span>, <span class="nv">TOUT</span> <span class="nv">is</span> <span class="nv">ignored</span> <span class="nv">after</span>
      <span class="nv">the</span> <span class="nv">first</span> <span class="nv">call</span> <span class="ss">(</span><span class="nv">i</span>.<span class="nv">e</span>. <span class="nv">the</span> <span class="nv">first</span> <span class="k">call</span> <span class="nl">with</span> <span class="nv">TOUT</span> .<span class="nv">ne</span>. <span class="nv">T</span><span class="ss">)</span>.
      <span class="nv">Otherwise</span>, <span class="nv">TOUT</span> <span class="nv">is</span> <span class="nv">required</span> <span class="nv">on</span> <span class="nv">every</span> <span class="nv">call</span>.

      <span class="k">If</span> <span class="nv">ITASK</span> <span class="o">=</span> <span class="mi">1</span>, <span class="mi">3</span>, <span class="nv">or</span> <span class="mi">4</span>, <span class="nv">the</span> <span class="nv">values</span> <span class="nv">of</span> <span class="nv">TOUT</span> <span class="nv">need</span> <span class="nv">not</span> <span class="nv">be</span>
      <span class="nv">monotone</span>, <span class="nv">but</span> <span class="nv">a</span> <span class="nv">value</span> <span class="nv">of</span> <span class="nv">TOUT</span> <span class="nv">which</span> <span class="nv">backs</span> <span class="nv">up</span> <span class="nv">is</span> <span class="nv">limited</span>
      <span class="nv">to</span> <span class="nv">the</span> <span class="nv">current</span> <span class="nv">internal</span> <span class="nv">T</span> <span class="nv">interval</span>, <span class="nv">whose</span> <span class="nv">endpoints</span> <span class="nv">are</span>
      <span class="nv">TCUR</span> <span class="o">-</span> <span class="nv">HU</span> <span class="nv">and</span> <span class="nv">TCUR</span> <span class="ss">(</span><span class="nv">see</span> <span class="nv">optional</span> <span class="nv">outputs</span>, <span class="nv">below</span>, <span class="k">for</span>
      <span class="nv">TCUR</span> <span class="nv">and</span> <span class="nv">HU</span><span class="ss">)</span>.
</code></pre></div>

<p>ITOL   = an indicator for the type of error control.  See
          description below under ATOL.  Used only for input.</p>
<p>RTOL   = a relative error tolerance parameter, either a scalar or
          an array of length NEQ.  See description below under ATOL.
          Input only.</p>
<p>ATOL   = an absolute error tolerance parameter, either a scalar or
          an array of length NEQ.  Input only.</p>
<div class="codehilite"><pre><span></span><code>         <span class="nv">The</span> <span class="nv">input</span> <span class="nv">parameters</span> <span class="nv">ITOL</span>, <span class="nv">RTOL</span>, <span class="nv">and</span> <span class="nv">ATOL</span> <span class="nv">determine</span>
      <span class="nv">the</span> <span class="nv">error</span> <span class="nv">control</span> <span class="nv">performed</span> <span class="nv">by</span> <span class="nv">the</span> <span class="nv">solver</span>.  <span class="nv">The</span> <span class="nv">solver</span> <span class="nv">will</span>
      <span class="nv">control</span> <span class="nv">the</span> <span class="nv">vector</span> <span class="nv">E</span> <span class="o">=</span> <span class="ss">(</span><span class="nv">E</span><span class="ss">(</span><span class="nv">i</span><span class="ss">))</span> <span class="nv">of</span> <span class="nv">estimated</span> <span class="nv">local</span> <span class="nv">errors</span>
      <span class="nv">in</span> <span class="nv">y</span>, <span class="nv">according</span> <span class="nv">to</span> <span class="nv">an</span> <span class="nv">inequality</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">form</span>
                  <span class="nv">RMS</span><span class="o">-</span><span class="nv">norm</span> <span class="nv">of</span> <span class="ss">(</span> <span class="nv">E</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">/</span><span class="nv">EWT</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span> <span class="ss">)</span>   .<span class="nv">le</span>.   <span class="mi">1</span>,
      <span class="nv">where</span>       <span class="nv">EWT</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">RTOL</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">*</span><span class="nv">ABS</span><span class="ss">(</span><span class="nv">Y</span><span class="ss">(</span><span class="nv">i</span><span class="ss">))</span> <span class="o">+</span> <span class="nv">ATOL</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>,
      <span class="nv">and</span> <span class="nv">the</span> <span class="nv">RMS</span><span class="o">-</span><span class="nv">norm</span> <span class="ss">(</span><span class="nv">root</span><span class="o">-</span><span class="nv">mean</span><span class="o">-</span><span class="nv">square</span> <span class="nv">norm</span><span class="ss">)</span> <span class="nv">here</span> <span class="nv">is</span>
      <span class="nv">RMS</span><span class="o">-</span><span class="nv">norm</span><span class="ss">(</span><span class="nv">v</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">SQRT</span><span class="ss">(</span><span class="nv">sum</span> <span class="nv">v</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="nv">NEQ</span><span class="ss">)</span>.  <span class="nv">Here</span> <span class="nv">EWT</span> <span class="o">=</span> <span class="ss">(</span><span class="nv">EWT</span><span class="ss">(</span><span class="nv">i</span><span class="ss">))</span>
      <span class="nv">is</span> <span class="nv">a</span> <span class="nv">vector</span> <span class="nv">of</span> <span class="nv">weights</span> <span class="nv">which</span> <span class="nv">must</span> <span class="nv">always</span> <span class="nv">be</span> <span class="nv">positive</span>, <span class="nv">and</span>
      <span class="nv">the</span> <span class="nv">values</span> <span class="nv">of</span> <span class="nv">RTOL</span> <span class="nv">and</span> <span class="nv">ATOL</span> <span class="nv">should</span> <span class="nv">all</span> <span class="nv">be</span> <span class="nv">non</span><span class="o">-</span><span class="nv">negative</span>.
      <span class="nv">The</span> <span class="nv">following</span> <span class="nv">table</span> <span class="nv">gives</span> <span class="nv">the</span> <span class="nv">types</span> <span class="ss">(</span><span class="nv">scalar</span><span class="o">/</span><span class="nv">array</span><span class="ss">)</span> <span class="nv">of</span>
      <span class="nv">RTOL</span> <span class="nv">and</span> <span class="nv">ATOL</span>, <span class="nv">and</span> <span class="nv">the</span> <span class="nv">corresponding</span> <span class="nv">form</span> <span class="nv">of</span> <span class="nv">EWT</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>.

         <span class="nv">ITOL</span>    <span class="nv">RTOL</span>       <span class="nv">ATOL</span>          <span class="nv">EWT</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>
          <span class="mi">1</span>     <span class="nv">scalar</span>     <span class="nv">scalar</span>     <span class="nv">RTOL</span><span class="o">*</span><span class="nv">ABS</span><span class="ss">(</span><span class="nv">Y</span><span class="ss">(</span><span class="nv">i</span><span class="ss">))</span> <span class="o">+</span> <span class="nv">ATOL</span>
          <span class="mi">2</span>     <span class="nv">scalar</span>     <span class="nv">array</span>      <span class="nv">RTOL</span><span class="o">*</span><span class="nv">ABS</span><span class="ss">(</span><span class="nv">Y</span><span class="ss">(</span><span class="nv">i</span><span class="ss">))</span> <span class="o">+</span> <span class="nv">ATOL</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>
          <span class="mi">3</span>     <span class="nv">array</span>      <span class="nv">scalar</span>     <span class="nv">RTOL</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">*</span><span class="nv">ABS</span><span class="ss">(</span><span class="nv">Y</span><span class="ss">(</span><span class="nv">i</span><span class="ss">))</span> <span class="o">+</span> <span class="nv">ATOL</span>
          <span class="mi">4</span>     <span class="nv">array</span>      <span class="nv">scalar</span>     <span class="nv">RTOL</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">*</span><span class="nv">ABS</span><span class="ss">(</span><span class="nv">Y</span><span class="ss">(</span><span class="nv">i</span><span class="ss">))</span> <span class="o">+</span> <span class="nv">ATOL</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>

      <span class="nv">When</span> <span class="nv">either</span> <span class="nv">of</span> <span class="nv">these</span> <span class="nv">parameters</span> <span class="nv">is</span> <span class="nv">a</span> <span class="nv">scalar</span>, <span class="nv">it</span> <span class="nv">need</span> <span class="nv">not</span>
      <span class="nv">be</span> <span class="nv">dimensioned</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">user</span><span class="s1">&#39;</span><span class="s">s calling program.</span>

      <span class="k">If</span> <span class="nv">none</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">above</span> <span class="nv">choices</span> <span class="ss">(</span><span class="nv">with</span> <span class="nv">ITOL</span>, <span class="nv">RTOL</span>, <span class="nv">and</span> <span class="nv">ATOL</span>
      <span class="nv">fixed</span> <span class="nv">throughout</span> <span class="nv">the</span> <span class="nv">problem</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">suitable</span>, <span class="nv">more</span> <span class="nv">general</span>
      <span class="nv">error</span> <span class="nv">controls</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">obtained</span> <span class="nv">by</span> <span class="nv">substituting</span>
      <span class="nv">user</span><span class="o">-</span><span class="nv">supplied</span> <span class="nv">routines</span> <span class="k">for</span> <span class="nv">the</span> <span class="nv">setting</span> <span class="nv">of</span> <span class="nv">EWT</span> <span class="nv">and</span><span class="o">/</span><span class="nv">or</span> <span class="k">for</span>
      <span class="nv">the</span> <span class="nv">norm</span> <span class="nv">calculation</span>.  <span class="nv">See</span> <span class="nv">Part</span> <span class="mi">4</span> <span class="nv">below</span>.

      <span class="k">If</span> <span class="nv">global</span> <span class="nv">errors</span> <span class="nv">are</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">estimated</span> <span class="nv">by</span> <span class="nv">making</span> <span class="nv">a</span> <span class="nv">repeated</span>
      <span class="nv">run</span> <span class="nv">on</span> <span class="nv">the</span> <span class="nv">same</span> <span class="nv">problem</span> <span class="nv">with</span> <span class="nv">smaller</span> <span class="nv">tolerances</span>, <span class="k">then</span> <span class="nv">all</span>
      <span class="nv">components</span> <span class="nv">of</span> <span class="nv">RTOL</span> <span class="nv">and</span> <span class="nv">ATOL</span> <span class="ss">(</span><span class="nv">i</span>.<span class="nv">e</span>. <span class="nv">of</span> <span class="nv">EWT</span><span class="ss">)</span> <span class="nv">should</span> <span class="nv">be</span> <span class="nv">scaled</span>
      <span class="nv">down</span> <span class="nv">uniformly</span>.
</code></pre></div>

<p>ITASK  = an index specifying the task to be performed.
          Input only.  ITASK has the following values and meanings.
          1  means normal computation of output values of y(t) at
             t = TOUT (by overshooting and interpolating).
          2  means take one step only and return.
          3  means stop at the first internal mesh point at or
             beyond t = TOUT and return.
          4  means normal computation of output values of y(t) at
             t = TOUT but without overshooting t = TCRIT.
             TCRIT must be input as RWORK(1).  TCRIT may be equal to
             or beyond TOUT, but not behind it in the direction of
             integration.  This option is useful if the problem
             has a singularity at or beyond t = TCRIT.
          5  means take one step, without passing TCRIT, and return.
             TCRIT must be input as RWORK(1).</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">Note</span>:  <span class="k">If</span> <span class="nv">ITASK</span> <span class="o">=</span> <span class="mi">4</span> <span class="nv">or</span> <span class="mi">5</span> <span class="nv">and</span> <span class="nv">the</span> <span class="nv">solver</span> <span class="nv">reaches</span> <span class="nv">TCRIT</span>
      <span class="ss">(</span><span class="nv">within</span> <span class="nv">roundoff</span><span class="ss">)</span>, <span class="nv">it</span> <span class="nv">will</span> <span class="k">return</span> <span class="nv">T</span> <span class="o">=</span> <span class="nv">TCRIT</span> <span class="ss">(</span><span class="nv">exactly</span><span class="ss">)</span> <span class="nv">to</span>
      <span class="nv">indicate</span> <span class="nv">this</span> <span class="ss">(</span><span class="nv">unless</span> <span class="nv">ITASK</span> <span class="o">=</span> <span class="mi">4</span> <span class="nv">and</span> <span class="nv">TOUT</span> <span class="nv">comes</span> <span class="nv">before</span> <span class="nv">TCRIT</span>,
      <span class="nv">in</span> <span class="nv">which</span> <span class="nv">case</span> <span class="nv">answers</span> <span class="nv">at</span> <span class="nv">t</span> <span class="o">=</span> <span class="nv">TOUT</span> <span class="nv">are</span> <span class="nv">returned</span> <span class="nv">first</span><span class="ss">)</span>.
</code></pre></div>

<p>ISTATE = an index used for input and output to specify the
          state of the calculation.</p>
<div class="codehilite"><pre><span></span><code><span class="w">      </span><span class="n">On</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ISTATE</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">follows</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="mi">0</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">problem</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"></span>
<span class="w">         </span><span class="n">DLSODI</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">compute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">dy</span><span class="o">/</span><span class="n">dt</span><span class="w"></span>
<span class="w">         </span><span class="p">(</span><span class="k">while</span><span class="w"> </span><span class="n">doing</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">initializations</span><span class="p">)</span><span class="o">.</span><span class="w">  </span><span class="n">See</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="mi">1</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">problem</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"></span>
<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">dy</span><span class="o">/</span><span class="n">dt</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="ow">in</span><span class="w"></span>
<span class="w">         </span><span class="n">YDOTI</span><span class="w"> </span><span class="p">(</span><span class="n">DLSODI</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">initializations</span><span class="p">)</span><span class="o">.</span><span class="w">  </span><span class="n">See</span><span class="w"> </span><span class="n">note</span><span class="w"></span>
<span class="w">         </span><span class="n">below</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="mi">2</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">call</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">calculation</span><span class="w"></span>
<span class="w">         </span><span class="k">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">continue</span><span class="w"> </span><span class="n">normally</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">input</span><span class="w"></span>
<span class="w">         </span><span class="n">parameters</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="n">possibly</span><span class="w"> </span><span class="n">TOUT</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ITASK</span><span class="o">.</span><span class="w"></span>
<span class="w">         </span><span class="p">(</span><span class="n">If</span><span class="w"> </span><span class="n">ITOL</span><span class="p">,</span><span class="w"> </span><span class="n">RTOL</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">ATOL</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">calls</span><span class="w"></span>
<span class="w">         </span><span class="n">with</span><span class="w"> </span><span class="n">ISTATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"></span>
<span class="w">         </span><span class="n">tested</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">legality</span><span class="o">.</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="mi">3</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">call</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="w">         </span><span class="n">calculation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">continue</span><span class="w"> </span><span class="n">normally</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">with</span><span class="w"></span>
<span class="w">         </span><span class="n">a</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"></span>
<span class="w">         </span><span class="n">TOUT</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ITASK</span><span class="o">.</span><span class="w">  </span><span class="n">Changes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="ow">in</span><span class="w"></span>
<span class="w">         </span><span class="n">NEQ</span><span class="p">,</span><span class="w"> </span><span class="n">ITOL</span><span class="p">,</span><span class="w"> </span><span class="n">RTOL</span><span class="p">,</span><span class="w"> </span><span class="n">ATOL</span><span class="p">,</span><span class="w"> </span><span class="n">IOPT</span><span class="p">,</span><span class="w"> </span><span class="n">LRW</span><span class="p">,</span><span class="w"> </span><span class="n">LIW</span><span class="p">,</span><span class="w"> </span><span class="n">MF</span><span class="p">,</span><span class="w"> </span><span class="n">ML</span><span class="p">,</span><span class="w"> </span><span class="n">MU</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="ow">and</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="n">H0</span><span class="o">.</span><span class="w"></span>
<span class="w">         </span><span class="p">(</span><span class="n">See</span><span class="w"> </span><span class="n">IWORK</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">ML</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">MU</span><span class="o">.</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">Note</span><span class="p">:</span><span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">preliminary</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">TOUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">counted</span><span class="w"></span>
<span class="w">      </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">here</span><span class="p">,</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">checking</span><span class="w"> </span><span class="n">of</span><span class="w"></span>
<span class="w">      </span><span class="n">input</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">done</span><span class="o">.</span><span class="w">  </span><span class="p">(</span><span class="n">Such</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">sometimes</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="w">      </span><span class="n">purpose</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">outputting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">conditions</span><span class="o">.</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">Thus</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">TOUT</span><span class="w"> </span><span class="o">.</span><span class="n">ne</span><span class="o">.</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">requires</span><span class="w"></span>
<span class="w">      </span><span class="n">ISTATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="w"></span>

<span class="w">      </span><span class="n">On</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">ISTATE</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">meanings</span><span class="o">.</span><span class="w"></span>
<span class="w">       </span><span class="mi">0</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">done</span><span class="p">;</span><span class="w"> </span><span class="n">TOUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">and</span><span class="w"></span>
<span class="w">          </span><span class="n">ISTATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="w"></span>
<span class="w">       </span><span class="mi">2</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">performed</span><span class="w"> </span><span class="n">successfully</span><span class="o">.</span><span class="w"></span>
<span class="w">       </span><span class="mi">3</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">supplied</span><span class="w"> </span><span class="n">Subroutine</span><span class="w"> </span><span class="n">RES</span><span class="w"> </span><span class="n">signalled</span><span class="w"></span>
<span class="w">          </span><span class="n">DLSODI</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">halt</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">IRES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="w"></span>
<span class="w">          </span><span class="n">Integration</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">achieved</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">occurrence</span><span class="w"></span>
<span class="w">          </span><span class="n">of</span><span class="w"> </span><span class="n">IRES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">attempting</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="w">          </span><span class="n">next</span><span class="w"> </span><span class="n">step</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">excessive</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="p">(</span><span class="n">more</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">MXSTEP</span><span class="w"></span>
<span class="w">          </span><span class="n">steps</span><span class="p">)</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">call</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">completing</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="w">          </span><span class="n">requested</span><span class="w"> </span><span class="n">task</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">otherwise</span><span class="w"></span>
<span class="w">          </span><span class="n">successful</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="w">  </span><span class="p">(</span><span class="n">MXSTEP</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">input</span><span class="w"></span>
<span class="w">          </span><span class="ow">and</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="mf">500.</span><span class="p">)</span><span class="w">  </span><span class="n">To</span><span class="w"> </span><span class="k">continue</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">may</span><span class="w"></span>
<span class="w">          </span><span class="n">simply</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">ISTATE</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">.</span><span class="n">gt</span><span class="o">.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">again</span><span class="w"></span>
<span class="w">          </span><span class="p">(</span><span class="n">the</span><span class="w"> </span><span class="n">excess</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="w"></span>
<span class="w">          </span><span class="n">In</span><span class="w"> </span><span class="n">addition</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">increase</span><span class="w"> </span><span class="n">MXSTEP</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">avoid</span><span class="w"></span>
<span class="w">          </span><span class="n">this</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">inputs</span><span class="p">)</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">2</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">accuracy</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">requested</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">precision</span><span class="w"></span>
<span class="w">          </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">  </span><span class="n">This</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">detected</span><span class="w"> </span><span class="n">before</span><span class="w"></span>
<span class="w">          </span><span class="n">completing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">requested</span><span class="w"> </span><span class="n">task</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">integration</span><span class="w"></span>
<span class="w">          </span><span class="n">was</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="w">  </span><span class="n">To</span><span class="w"> </span><span class="k">continue</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tolerance</span><span class="w"></span>
<span class="w">          </span><span class="n">parameters</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reset</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ISTATE</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"></span>
<span class="w">          </span><span class="n">to</span><span class="w"> </span><span class="mf">3.</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">TOLSF</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"></span>
<span class="w">          </span><span class="n">purpose</span><span class="o">.</span><span class="w">  </span><span class="p">(</span><span class="n">Note</span><span class="p">:</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">detected</span><span class="w"> </span><span class="n">before</span><span class="w"></span>
<span class="w">          </span><span class="n">taking</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">steps</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">illegal</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="k">return</span><span class="w"></span>
<span class="w">          </span><span class="p">(</span><span class="n">ISTATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">3</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">illegal</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">detected</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">taking</span><span class="w"> </span><span class="n">any</span><span class="w"></span>
<span class="w">          </span><span class="n">integration</span><span class="w"> </span><span class="n">steps</span><span class="o">.</span><span class="w">  </span><span class="n">See</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="o">.</span><span class="w"></span>
<span class="w">          </span><span class="n">Note</span><span class="p">:</span><span class="w">  </span><span class="n">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">solver</span><span class="w"> </span><span class="n">detects</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">infinite</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">calls</span><span class="w"></span>
<span class="w">          </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">solver</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">illegal</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"></span>
<span class="w">          </span><span class="n">the</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">stop</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">4</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">repeated</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">failures</span><span class="w"> </span><span class="n">on</span><span class="w"></span>
<span class="w">          </span><span class="n">one</span><span class="w"> </span><span class="n">attempted</span><span class="w"> </span><span class="n">step</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">completing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">requested</span><span class="w"></span>
<span class="w">          </span><span class="n">task</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="w"></span>
<span class="w">          </span><span class="n">The</span><span class="w"> </span><span class="n">problem</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">singularity</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">input</span><span class="w"></span>
<span class="w">          </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">inappropriate</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">5</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">repeated</span><span class="w"> </span><span class="n">convergence</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">failures</span><span class="w"> </span><span class="n">on</span><span class="w"></span>
<span class="w">          </span><span class="n">one</span><span class="w"> </span><span class="n">attempted</span><span class="w"> </span><span class="n">step</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">completing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">requested</span><span class="w"></span>
<span class="w">          </span><span class="n">task</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="w"></span>
<span class="w">          </span><span class="n">This</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">caused</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">inaccurate</span><span class="w"> </span><span class="n">Jacobian</span><span class="w"> </span><span class="n">matrix</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">6</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">EWT</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">became</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="w">          </span><span class="n">integration</span><span class="o">.</span><span class="w">  </span><span class="n">pure</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="p">(</span><span class="n">ATOL</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="n">was</span><span class="w"> </span><span class="n">requested</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">vanished</span><span class="o">.</span><span class="w"></span>
<span class="w">          </span><span class="n">the</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">7</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">supplied</span><span class="w"> </span><span class="n">Subroutine</span><span class="w"> </span><span class="n">RES</span><span class="w"> </span><span class="n">set</span><span class="w"></span>
<span class="w">          </span><span class="n">its</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="p">(</span><span class="n">IRES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">despite</span><span class="w"> </span><span class="n">repeated</span><span class="w"> </span><span class="n">tries</span><span class="w"> </span><span class="n">by</span><span class="w"></span>
<span class="w">          </span><span class="n">DLSODI</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">condition</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">-</span><span class="mi">8</span><span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">ISTATE</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">DLSODI</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">unable</span><span class="w"></span>
<span class="w">          </span><span class="n">to</span><span class="w"> </span><span class="n">compute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">dy</span><span class="o">/</span><span class="n">dt</span><span class="o">.</span><span class="w">  </span><span class="n">See</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="w">          </span><span class="n">printed</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="o">.</span><span class="w"></span>

<span class="w">      </span><span class="n">Note</span><span class="p">:</span><span class="w">  </span><span class="n">Since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ISTATE</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="n">it</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">continuation</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="n">Similarly</span><span class="p">,</span><span class="w"> </span><span class="n">ISTATE</span><span class="w"> </span><span class="p">(</span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">RES</span><span class="w"> </span><span class="n">told</span><span class="w"></span>
<span class="w">      </span><span class="n">DLSODI</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">change</span><span class="w"></span>
<span class="w">      </span><span class="n">the</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">problem</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="n">Also</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">negative</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ISTATE</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"></span>
<span class="w">      </span><span class="n">regarded</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">illegal</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">negative</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="w">      </span><span class="n">user</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">possibly</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">inputs</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"></span>
<span class="w">      </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">solver</span><span class="w"> </span><span class="n">again</span><span class="o">.</span><span class="w"></span>
</code></pre></div>

<p>IOPT   = an integer flag to specify whether or not any optional
          inputs are being used on this call.  Input only.
          The optional inputs are listed separately below.
          IOPT = 0 means no optional inputs are being used.
                   Default values will be used in all cases.
          IOPT = 1 means one or more optional inputs are being used.</p>
<p>RWORK  = a real working array (double precision).
          The length of RWORK must be at least
             20 + NYH<em>(MAXORD + 1) + 3</em>NEQ + LENWM    where
          NYH    = the initial value of NEQ,
          MAXORD = 12 (if METH = 1) or 5 (if METH = 2) (unless a
                   smaller value is given as an optional input),
          LENWM   = NEQ<strong>2 + 2    if MITER is 1 or 2, and
          LENWM   = (2<em>ML+MU+1)</em>NEQ + 2 if MITER is 4 or 5.
          (See MF description for the definition of METH and MITER.)
          Thus if MAXORD has its default value and NEQ is constant,
          this length is
             22 + 16*NEQ + NEQ</strong>2         for MF = 11 or 12,
             22 + 17<em>NEQ + (2</em>ML+MU)<em>NEQ  for MF = 14 or 15,
             22 +  9</em>NEQ + NEQ<em><em>2         for MF = 21 or 22,
             22 + 10</em>NEQ + (2</em>ML+MU)*NEQ  for MF = 24 or 25.
          The first 20 words of RWORK are reserved for conditional
          and optional inputs and optional outputs.</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">The</span> <span class="nv">following</span> <span class="nv">word</span> <span class="nv">in</span> <span class="nv">RWORK</span> <span class="nv">is</span> <span class="nv">a</span> <span class="nv">conditional</span> <span class="nv">input</span>:
        <span class="nv">RWORK</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">TCRIT</span> <span class="o">=</span> <span class="nv">critical</span> <span class="nv">value</span> <span class="nv">of</span> <span class="nv">t</span> <span class="nv">which</span> <span class="nv">the</span> <span class="nv">solver</span>
                   <span class="nv">is</span> <span class="nv">not</span> <span class="nv">to</span> <span class="nv">overshoot</span>.  <span class="nv">Required</span> <span class="k">if</span> <span class="nv">ITASK</span> <span class="nv">is</span>
                   <span class="mi">4</span> <span class="nv">or</span> <span class="mi">5</span>, <span class="nv">and</span> <span class="nv">ignored</span> <span class="nv">otherwise</span>.  <span class="ss">(</span><span class="nv">See</span> <span class="nv">ITASK</span>.<span class="ss">)</span>
</code></pre></div>

<p>LRW    = the length of the array RWORK, as declared by the user.
          (This will be checked by the solver.)</p>
<p>IWORK  = an integer work array.  The length of IWORK must be at least
          20 + NEQ .  The first few words of IWORK are used for
          conditional and optional inputs and optional outputs.</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">The</span> <span class="nv">following</span> <span class="mi">2</span> <span class="nv">words</span> <span class="nv">in</span> <span class="nv">IWORK</span> <span class="nv">are</span> <span class="nv">conditional</span> <span class="nv">inputs</span>:
        <span class="nv">IWORK</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">ML</span>     <span class="nv">These</span> <span class="nv">are</span> <span class="nv">the</span> <span class="nv">lower</span> <span class="nv">and</span> <span class="nv">upper</span>
        <span class="nv">IWORK</span><span class="ss">(</span><span class="mi">2</span><span class="ss">)</span> <span class="o">=</span> <span class="nv">MU</span>     <span class="nv">half</span><span class="o">-</span><span class="nv">bandwidths</span>, <span class="nv">respectively</span>, <span class="nv">of</span> <span class="nv">the</span>
                   <span class="nv">matrices</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">problem</span><span class="o">--</span> <span class="nv">the</span> <span class="nv">Jacobian</span> <span class="nv">dr</span><span class="o">/</span><span class="nv">dy</span>
                   <span class="nv">and</span> <span class="nv">the</span> <span class="nv">left</span><span class="o">-</span><span class="nv">hand</span> <span class="nv">side</span> <span class="nv">matrix</span> <span class="nv">A</span>. <span class="nv">These</span>
                   <span class="nv">half</span><span class="o">-</span><span class="nv">bandwidths</span> <span class="nv">exclude</span> <span class="nv">the</span> <span class="nv">main</span> <span class="nv">diagonal</span>,
                   <span class="nv">so</span> <span class="nv">the</span> <span class="nv">total</span> <span class="nv">bandwidth</span> <span class="nv">is</span> <span class="nv">ML</span> <span class="o">+</span> <span class="nv">MU</span> <span class="o">+</span> <span class="mi">1</span> .
                   <span class="nv">The</span> <span class="nv">band</span> <span class="nv">is</span> <span class="nv">defined</span> <span class="nv">by</span> <span class="nv">the</span> <span class="nv">matrix</span> <span class="nv">locations</span>
                   <span class="ss">(</span><span class="nv">i</span>,<span class="nv">j</span><span class="ss">)</span> <span class="nv">with</span> <span class="nv">i</span><span class="o">-</span><span class="nv">ML</span> .<span class="nv">le</span>. <span class="nv">j</span> .<span class="nv">le</span>. <span class="nv">i</span><span class="o">+</span><span class="nv">MU</span>.  <span class="nv">ML</span> <span class="nv">and</span> <span class="nv">MU</span>
                   <span class="nv">must</span> <span class="nv">satisfy</span>  <span class="mi">0</span> .<span class="nv">le</span>.  <span class="nv">ML</span>,<span class="nv">MU</span>  .<span class="nv">le</span>. <span class="nv">NEQ</span><span class="o">-</span><span class="mi">1</span>.
                   <span class="nv">These</span> <span class="nv">are</span> <span class="nv">required</span> <span class="k">if</span> <span class="nv">MITER</span> <span class="nv">is</span> <span class="mi">4</span> <span class="nv">or</span> <span class="mi">5</span>, <span class="nv">and</span>
                   <span class="nv">ignored</span> <span class="nv">otherwise</span>.
                   <span class="nv">ML</span> <span class="nv">and</span> <span class="nv">MU</span> <span class="nv">may</span> <span class="nv">in</span> <span class="nv">fact</span> <span class="nv">be</span> <span class="nv">the</span> <span class="nv">band</span> <span class="nv">parameters</span>
                   <span class="k">for</span> <span class="nv">matrices</span> <span class="nv">to</span> <span class="nv">which</span> <span class="nv">dr</span><span class="o">/</span><span class="nv">dy</span> <span class="nv">and</span> <span class="nv">A</span> <span class="nv">are</span> <span class="nv">only</span>
                   <span class="nv">approximately</span> <span class="nv">equal</span>.
</code></pre></div>

<p>LIW    = the length of the array IWORK, as declared by the user.
          (This will be checked by the solver.)</p>
<p>Note:  The work arrays must not be altered between calls to DLSODI
 for the same problem, except possibly for the conditional and
 optional inputs, and except for the last 3*NEQ words of RWORK.
 The latter space is used for internal scratch space, and so is
 available for use by the user outside DLSODI between calls, if
 desired (but not for use by RES, ADDA, or JAC).</p>
<p>MF     = the method flag.  Used only for input.  The legal values of
          MF are 11, 12, 14, 15, 21, 22, 24, and 25.
          MF has decimal digits METH and MITER: MF = 10*METH + MITER.
            METH indicates the basic linear multistep method:
              METH = 1 means the implicit Adams method.
              METH = 2 means the method based on Backward
                       Differentiation Formulas (BDFs).
                The BDF method is strongly preferred for stiff
              problems, while the Adams method is preferred when
              the problem is not stiff.  If the matrix A(t,y) is
              nonsingular, stiffness here can be taken to mean that of
              the explicit ODE system dy/dt = A-inverse * g.  If A is
              singular, the concept of stiffness is not well defined.
                If you do not know whether the problem is stiff, we
              recommend using METH = 2.  If it is stiff, the advantage
              of METH = 2 over METH = 1 will be great, while if it is
              not stiff, the advantage of METH = 1 will be slight.
              If maximum efficiency is important, some experimentation
              with METH may be necessary.
            MITER indicates the corrector iteration method:
              MITER = 1 means chord iteration with a user-supplied
                        full (NEQ by NEQ) Jacobian.
              MITER = 2 means chord iteration with an internally
                        generated (difference quotient) full Jacobian.
                        This uses NEQ+1 extra calls to RES per dr/dy
                        evaluation.
              MITER = 4 means chord iteration with a user-supplied
                        banded Jacobian.
              MITER = 5 means chord iteration with an internally
                        generated banded Jacobian (using ML+MU+2
                        extra calls to RES per dr/dy evaluation).
              If MITER = 1 or 4, the user must supply a Subroutine JAC
              (the name is arbitrary) as described above under JAC.
              For other values of MITER, a dummy argument can be used.</p>
<hr>
<p>Optional Inputs.</p>
<p>The following is a list of the optional inputs provided for in the
 call sequence.  (See also Part 2.)  For each such input variable,
 this table lists its name as used in this documentation, its
 location in the call sequence, its meaning, and the default value.
 the use of any of these inputs requires IOPT = 1, and in that
 case all of these inputs are examined.  A value of zero for any
 of these optional inputs will cause the default value to be used.
 Thus to use a subset of the optional inputs, simply preload
 locations 5 to 10 in RWORK and IWORK to 0.0 and 0 respectively, and
 then set those of interest to nonzero values.</p>
<p>Name    Location      Meaning and Default Value</p>
<p>H0      RWORK(5)  the step size to be attempted on the first step.
                   The default value is determined by the solver.</p>
<p>HMAX    RWORK(6)  the maximum absolute step size allowed.
                   The default value is infinite.</p>
<p>HMIN    RWORK(7)  the minimum absolute step size allowed.
                   The default value is 0.  (This lower bound is not
                   enforced on the final step before reaching TCRIT
                   when ITASK = 4 or 5.)</p>
<p>MAXORD  IWORK(5)  the maximum order to be allowed.  The default
                   value is 12 if METH = 1, and 5 if METH = 2.
                   If MAXORD exceeds the default value, it will
                   be reduced to the default value.
                   If MAXORD is changed during the problem, it may
                   cause the current order to be reduced.</p>
<p>MXSTEP  IWORK(6)  maximum number of (internally defined) steps
                   allowed during one call to the solver.
                   The default value is 500.</p>
<p>MXHNIL  IWORK(7)  maximum number of messages printed (per problem)
                   warning that T + H = T on a step (H = step size).
                   This must be positive to result in a non-default
                   value.  The default value is 10.</p>
<hr>
<p>Optional Outputs.</p>
<p>As optional additional output from DLSODI, the variables listed
 below are quantities related to the performance of DLSODI
 which are available to the user.  These are communicated by way of
 the work arrays, but also have internal mnemonic names as shown.
 Except where stated otherwise, all of these outputs are defined
 on any successful return from DLSODI, and on any return with
 ISTATE = -1, -2, -4, -5, -6, or -7.  On a return with -3 (illegal
 input) or -8, they will be unchanged from their existing values
 (if any), except possibly for TOLSF, LENRW, and LENIW.
 On any error return, outputs relevant to the error will be defined,
 as noted below.</p>
<p>Name    Location      Meaning</p>
<p>HU      RWORK(11) the step size in t last used (successfully).</p>
<p>HCUR    RWORK(12) the step size to be attempted on the next step.</p>
<p>TCUR    RWORK(13) the current value of the independent variable
                   which the solver has actually reached, i.e. the
                   current internal mesh point in t.  On output, TCUR
                   will always be at least as far as the argument
                   T, but may be farther (if interpolation was done).</p>
<p>TOLSF   RWORK(14) a tolerance scale factor, greater than 1.0,
                   computed when a request for too much accuracy was
                   detected (ISTATE = -3 if detected at the start of
                   the problem, ISTATE = -2 otherwise).  If ITOL is
                   left unaltered but RTOL and ATOL are uniformly
                   scaled up by a factor of TOLSF for the next call,
                   then the solver is deemed likely to succeed.
                   (The user may also ignore TOLSF and alter the
                   tolerance parameters in any other way appropriate.)</p>
<p>NST     IWORK(11) the number of steps taken for the problem so far.</p>
<p>NRE     IWORK(12) the number of residual evaluations (RES calls)
                   for the problem so far.</p>
<p>NJE     IWORK(13) the number of Jacobian evaluations (each involving
                   an evaluation of A and dr/dy) for the problem so
                   far.  This equals the number of calls to ADDA and
                   (if MITER = 1 or 4) JAC, and the number of matrix
                   LU decompositions.</p>
<p>NQU     IWORK(14) the method order last used (successfully).</p>
<p>NQCUR   IWORK(15) the order to be attempted on the next step.</p>
<p>IMXER   IWORK(16) the index of the component of largest magnitude in
                   the weighted local error vector ( E(i)/EWT(i) ),
                   on an error return with ISTATE = -4 or -5.</p>
<p>LENRW   IWORK(17) the length of RWORK actually required.
                   This is defined on normal returns and on an illegal
                   input return for insufficient storage.</p>
<p>LENIW   IWORK(18) the length of IWORK actually required.
                   This is defined on normal returns and on an illegal
                   input return for insufficient storage.</p>
<p>The following two arrays are segments of the RWORK array which
 may also be of interest to the user as optional outputs.
 For each array, the table below gives its internal name,
 its base address in RWORK, and its description.</p>
<p>Name    Base Address      Description</p>
<p>YH      21             the Nordsieck history array, of size NYH by
                        (NQCUR + 1), where NYH is the initial value
                        of NEQ.  For j = 0,1,&hellip;,NQCUR, column j+1
                        of YH contains HCUR**j/factorial(j) times
                        the j-th derivative of the interpolating
                        polynomial currently representing the solution,
                        evaluated at t = TCUR.</p>
<p>ACOR     LENRW-NEQ+1   array of size NEQ used for the accumulated
                        corrections on each step, scaled on output to
                        represent the estimated local error in y on the
                        last step. This is the vector E in the descrip-
                        tion of the error control.  It is defined only
                        on a return from DLSODI with ISTATE = 2.</p>
<hr>
<p>Part 2.  Other Routines Callable.</p>
<p>The following are optional calls which the user may make to
 gain additional capabilities in conjunction with DLSODI.
 (The routines XSETUN and XSETF are designed to conform to the
 SLATEC error handling package.)</p>
<div class="codehilite"><pre><span></span><code> Form of Call                  Function
</code></pre></div>

<p>CALL XSETUN(LUN)          Set the logical unit number, LUN, for
                             output of messages from DLSODI, if
                             the default is not desired.
                             The default value of LUN is 6.</p>
<p>CALL XSETF(MFLAG)         Set a flag to control the printing of
                             messages by DLSODI.
                             MFLAG = 0 means do not print. (Danger:
                             This risks losing valuable information.)
                             MFLAG = 1 means print (the default).</p>
<div class="codehilite"><pre><span></span><code>                         Either of the above calls may be made at
                         any time and will take effect immediately.
</code></pre></div>

<p>CALL DSRCOM(RSAV,ISAV,JOB) saves and restores the contents of
                             the internal Common blocks used by
                             DLSODI (see Part 3 below).
                             RSAV must be a real array of length 218
                             or more, and ISAV must be an integer
                             array of length 37 or more.
                             JOB=1 means save Common into RSAV/ISAV.
                             JOB=2 means restore Common from RSAV/ISAV.
                                DSRCOM is useful if one is
                             interrupting a run and restarting
                             later, or alternating between two or
                             more problems solved with DLSODI.</p>
<p>CALL DINTDY(,,,,,)        Provide derivatives of y, of various
        (see below)          orders, at a specified point t, if
                             desired.  It may be called only after
                             a successful return from DLSODI.</p>
<p>The detailed instructions for using DINTDY are as follows.
 The form of the call is:</p>
<p>CALL DINTDY (T, K, RWORK(21), NYH, DKY, IFLAG)</p>
<p>The input parameters are:</p>
<p>T         = value of independent variable where answers are desired
             (normally the same as the T last returned by DLSODI).
             For valid results, T must lie between TCUR - HU and TCUR.
             (See optional outputs for TCUR and HU.)
 K         = integer order of the derivative desired.  K must satisfy
             0 .le. K .le. NQCUR, where NQCUR is the current order
             (see optional outputs).  The capability corresponding
             to K = 0, i.e. computing y(T), is already provided
             by DLSODI directly.  Since NQCUR .ge. 1, the first
             derivative dy/dt is always available with DINTDY.
 RWORK(21) = the base address of the history array YH.
 NYH       = column length of YH, equal to the initial value of NEQ.</p>
<p>The output parameters are:</p>
<p>DKY       = a real array of length NEQ containing the computed value
             of the K-th derivative of y(t).
 IFLAG     = integer flag, returned as 0 if K and T were legal,
             -1 if K was illegal, and -2 if T was illegal.
             On an error return, a message is also written.</p>
<hr>
<p>Part 3.  Common Blocks.</p>
<p>If DLSODI is to be used in an overlay situation, the user
 must declare, in the primary overlay, the variables in:
   (1) the call sequence to DLSODI, and
   (2) the internal Common block
         /DLS001/  of length  255  (218 double precision words
                      followed by 37 integer words),</p>
<p>If DLSODI is used on a system in which the contents of internal
 Common blocks are not preserved between calls, the user should
 declare the above Common block in the calling program to insure
 that their contents are preserved.</p>
<p>If the solution of a given problem by DLSODI is to be interrupted
 and then later continued, such as when restarting an interrupted run
 or alternating between two or more problems, the user should save,
 following the return from the last DLSODI call prior to the
 interruption, the contents of the call sequence variables and the
 internal Common blocks, and later restore these values before the
 next DLSODI call for that problem.  To save and restore the Common
 blocks, use Subroutine DSRCOM (see Part 2 above).</p>
<hr>
<p>Part 4.  Optionally Replaceable Solver Routines.</p>
<p>Below are descriptions of two routines in the DLSODI package which
 relate to the measurement of errors.  Either routine can be
 replaced by a user-supplied version, if desired.  However, since such
 a replacement may have a major impact on performance, it should be
 done only when absolutely necessary, and only with great caution.
 (Note: The means by which the package version of a routine is
 superseded by the user&rsquo;s version may be system-dependent.)</p>
<p>(a) DEWSET.
 The following subroutine is called just before each internal
 integration step, and sets the array of error weights, EWT, as
 described under ITOL/RTOL/ATOL above:
     SUBROUTINE DEWSET (NEQ, ITOL, RTOL, ATOL, YCUR, EWT)
 where NEQ, ITOL, RTOL, and ATOL are as in the DLSODI call sequence,
 YCUR contains the current dependent variable vector, and
 EWT is the array of weights set by DEWSET.</p>
<p>If the user supplies this subroutine, it must return in EWT(i)
 (i = 1,&hellip;,NEQ) a positive quantity suitable for comparing errors
 in y(i) to.  The EWT array returned by DEWSET is passed to the DVNORM
 routine (see below), and also used by DLSODI in the computation
 of the optional output IMXER, the diagonal Jacobian approximation,
 and the increments for difference quotient Jacobians.</p>
<p>In the user-supplied version of DEWSET, it may be desirable to use
 the current values of derivatives of y.  Derivatives up to order NQ
 are available from the history array YH, described above under
 optional outputs.  In DEWSET, YH is identical to the YCUR array,
 extended to NQ + 1 columns with a column length of NYH and scale
 factors of H**j/factorial(j).  On the first call for the problem,
 given by NST = 0, NQ is 1 and H is temporarily set to 1.0.
 NYH is the initial value of NEQ.  The quantities NQ, H, and NST
 can be obtained by including in DEWSET the statements:
     DOUBLE PRECISION RLS
     COMMON /DLS001/ RLS(218),ILS(37)
     NQ = ILS(33)
     NST = ILS(34)
     H = RLS(212)
 Thus, for example, the current value of dy/dt can be obtained as
 YCUR(NYH+i)/H  (i=1,&hellip;,NEQ)  (and the division by H is
 unnecessary when NST = 0).</p>
<p>(b) DVNORM.
 The following is a real function routine which computes the weighted
 root-mean-square norm of a vector v:
     D = DVNORM (N, V, W)
 where:
   N = the length of the vector,
   V = real array of length N containing the vector,
   W = real array of length N containing weights,
   D = SQRT( (1/N) * sum(V(i)<em>W(i))</em>*2 ).
 DVNORM is called with N = NEQ and with W(i) = 1.0/EWT(i), where
 EWT is as set by Subroutine DEWSET.</p>
<p>If the user supplies this function, it should return a non-negative
 value of DVNORM suitable for use in the error control in DLSODI.
 None of the arguments should be altered by DVNORM.
 For example, a user-supplied DVNORM routine might:
   -substitute a max-norm of (V(i)*W(i)) for the RMS-norm, or
   -ignore some components of V in the norm, with the effect of
    suppressing the error control on those components of y.</p>
<hr>
<h3 id="revision-history-yyyymmdd">REVISION HISTORY  (YYYYMMDD)</h3>
<p>19800424  DATE WRITTEN
 19800519  Corrected access of YH on forced order reduction;
           numerous corrections to prologues and other comments.
 19800617  In main driver, added loading of SQRT(UROUND) in RWORK;
           minor corrections to main prologue.
 19800903  Corrected ISTATE logic; minor changes in prologue.
 19800923  Added zero initialization of HU and NQU.
 19801028  Reorganized RES calls in AINVG, STODI, and PREPJI;
           in LSODI, corrected NRE increment and reset LDY0 at 580;
           numerous corrections to main prologue.
 19801218  Revised XERRWD routine; minor corrections to main prologue.
 19810330  Added Common block /LSI001/; use LSODE&rsquo;s INTDY and SOLSY;
           minor corrections to XERRWD and error message at 604;
           minor corrections to declarations; corrections to prologues.
 19810818  Numerous revisions: replaced EWT by 1/EWT; used flags
           JCUR, ICF, IERPJ, IERSL between STODI and subordinates;
           added tuning parameters CCMAX, MAXCOR, MSBP, MXNCF;
           reorganized returns from STODI; reorganized type decls.;
           fixed message length in XERRWD; changed default LUNIT to 6;
           changed Common lengths; changed comments throughout.
 19820906  Corrected use of ABS(H) in STODI; minor comment fixes.
 19830510  Numerous revisions: revised diff. quotient increment;
           eliminated block /LSI001/, using IERPJ flag;
           revised STODI logic after PJAC return;
           revised tuning of H change and step attempts in STODI;
           corrections to main prologue and internal comments.
 19870330  Major update: corrected comments throughout;
           removed TRET from Common; rewrote EWSET with 4 loops;
           fixed t test in INTDY; added Cray directives in STODI;
           in STODI, fixed DELP init. and logic around PJAC call;
           combined routines to save/restore Common;
           passed LEVEL = 0 in error message calls (except run abort).
 20010425  Major update: convert source lines to upper case;
           added *DECK lines; changed from 1 to * in dummy dimensions;
           changed names R1MACH/D1MACH to RUMACH/DUMACH;
           renamed routines for uniqueness across single/double prec.;
           converted intrinsic names to generic form;
           removed ILLIN and NTREP (data loaded) from Common;
           removed all &lsquo;own&rsquo; variables from Common;
           changed error messages to quoted strings;
           replaced XERRWV/XERRWD with 1993 revised version;
           converted prologues, comments, error messages to mixed case;
           converted arithmetic IF statements to logical IF statements;
           numerous corrections to prologues and internal comments.
 20010507  Converted single precision source to double precision.
 20020502  Corrected declarations in descriptions of user routines.
 20031105  Restored &lsquo;own&rsquo; variables to Common block, to enable
           interrupt/restart feature.
 20031112  Added SAVE statements for data-loaded constants.
 20031117  Changed internal names NRE, LSAVR to NFE, LSAVF resp.</p>
<hr>
<p>Other routines in the DLSODI package.</p>
<p>In addition to Subroutine DLSODI, the DLSODI package includes the
 following subroutines and function routines:
  DAINVG   computes the initial value of the vector
             dy/dt = A-inverse * g
  DINTDY   computes an interpolated value of the y vector at t = TOUT.
  DSTODI   is the core integrator, which does one step of the
           integration and the associated error control.
  DCFODE   sets all method coefficients and test constants.
  DPREPJI  computes and preprocesses the Jacobian matrix
           and the Newton iteration matrix P.
  DSOLSY   manages solution of linear system in chord iteration.
  DEWSET   sets the error weight vector EWT before each step.
  DVNORM   computes the weighted RMS-norm of a vector.
  DSRCOM   is a user-callable routine to save and restore
           the contents of the internal Common blocks.
  DGEFA and DGESL   are routines from LINPACK for solving full
           systems of linear algebraic equations.
  DGBFA and DGBSL   are routines from LINPACK for solving banded
           linear systems.
  DUMACH   computes the unit roundoff in a machine-independent manner.
  XERRWD, XSETUN, XSETF, and IXSAV handle the printing of all
           error messages and warnings.  XERRWD is machine-dependent.
 Note:  DVNORM, DUMACH, and IXSAV are function routines.
 All the others are subroutines.</p>
<hr>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-res~7"></span>real</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>res</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-adda~7"></span>real</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>adda</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-jac~11"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>jac</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-neq~15"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Neq</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-y~15"></span>real(kind=dp)</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Y</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ydoti"></span>real(kind=dp)</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Ydoti</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-t~9"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>T</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-tout~6"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Tout</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-itol~7"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Itol</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-rtol~6"></span>real(kind=dp)</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Rtol</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-atol~7"></span>real(kind=dp)</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Atol</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-itask~5"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Itask</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-istate~5"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Istate</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-iopt~5"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Iopt</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-rwork~7"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Rwork</strong>(Lrw)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lrw~5"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Lrw</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-iwork~5"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Iwork</strong>(Liw)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-liw~5"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Liw</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mf~3"></span>integer</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>Mf</strong></td><td></td>
</tr>
</tbody>
</table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dlsodi~~CallsGraph Pages: 1 -->
<svg id="procdlsodiCallsGraph" width="334pt" height="280pt"
 viewBox="0.00 0.00 334.00 279.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dlsodi~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 275.91)">
<title>proc~~dlsodi~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-275.91 330,-275.91 330,4 -4,4"/>
<!-- proc~dlsodi -->
<g id="proc~~dlsodi~~CallsGraph_node1" class="node">
<title>proc~dlsodi</title>
<polygon fill="none" stroke="black" points="54,-167 0,-167 0,-143 54,-143 54,-167"/>
<text text-anchor="middle" x="27" y="-152.6" font-family="Helvetica,sans-Serif" font-size="10.50">dlsodi</text>
</g>
<!-- proc~dvnorm -->
<g id="proc~~dlsodi~~CallsGraph_node2" class="node">
<title>proc~dvnorm</title>
<g id="a_proc~~dlsodi~~CallsGraph_node2"><a xlink:href=".././proc/dvnorm.html" xlink:title="dvnorm">
<polygon fill="#d94e8f" stroke="#d94e8f" points="236,-271 182,-271 182,-247 236,-247 236,-271"/>
<text text-anchor="middle" x="209" y="-256.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dvnorm</text>
</a>
</g>
</g>
<!-- proc~dlsodi&#45;&gt;proc~dvnorm -->
<g id="proc~~dlsodi~~CallsGraph_edge1" class="edge">
<title>proc~dlsodi&#45;&gt;proc~dvnorm</title>
<path fill="none" stroke="#000000" d="M30.97,-167.27C37.3,-190.35 54.52,-239.74 90,-260 114.6,-274.04 147.04,-272.63 171.68,-268.35"/>
<polygon fill="#000000" stroke="#000000" points="172.58,-271.74 181.72,-266.38 171.23,-264.87 172.58,-271.74"/>
</g>
<!-- proc~dumach -->
<g id="proc~~dlsodi~~CallsGraph_node3" class="node">
<title>proc~dumach</title>
<g id="a_proc~~dlsodi~~CallsGraph_node3"><a xlink:href=".././proc/dumach.html" xlink:title="dumach">
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-251 90,-251 90,-227 146,-227 146,-251"/>
<text text-anchor="middle" x="118" y="-236.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dumach</text>
</a>
</g>
</g>
<!-- proc~dlsodi&#45;&gt;proc~dumach -->
<g id="proc~~dlsodi~~CallsGraph_edge2" class="edge">
<title>proc~dlsodi&#45;&gt;proc~dumach</title>
<path fill="none" stroke="#000000" d="M38.98,-167.08C51.04,-180.12 71.2,-201.27 90,-218 90.95,-218.84 91.93,-219.69 92.92,-220.54"/>
<polygon fill="#000000" stroke="#000000" points="90.76,-223.3 100.73,-226.9 95.19,-217.87 90.76,-223.3"/>
</g>
<!-- proc~dintdy -->
<g id="proc~~dlsodi~~CallsGraph_node4" class="node">
<title>proc~dintdy</title>
<g id="a_proc~~dlsodi~~CallsGraph_node4"><a xlink:href=".././proc/dintdy.html" xlink:title="dintdy">
<polygon fill="#d9534f" stroke="#d9534f" points="145,-167 91,-167 91,-143 145,-143 145,-167"/>
<text text-anchor="middle" x="118" y="-152.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dintdy</text>
</a>
</g>
</g>
<!-- proc~dlsodi&#45;&gt;proc~dintdy -->
<g id="proc~~dlsodi~~CallsGraph_edge3" class="edge">
<title>proc~dlsodi&#45;&gt;proc~dintdy</title>
<path fill="none" stroke="#000000" d="M54.22,-155C62.55,-155 71.91,-155 80.82,-155"/>
<polygon fill="#000000" stroke="#000000" points="80.97,-158.5 90.97,-155 80.97,-151.5 80.97,-158.5"/>
</g>
<!-- proc~xerrwd -->
<g id="proc~~dlsodi~~CallsGraph_node5" class="node">
<title>proc~xerrwd</title>
<g id="a_proc~~dlsodi~~CallsGraph_node5"><a xlink:href=".././proc/xerrwd.html" xlink:title="xerrwd">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-147 182,-147 182,-123 236,-123 236,-147"/>
<text text-anchor="middle" x="209" y="-132.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xerrwd</text>
</a>
</g>
</g>
<!-- proc~dlsodi&#45;&gt;proc~xerrwd -->
<g id="proc~~dlsodi~~CallsGraph_edge4" class="edge">
<title>proc~dlsodi&#45;&gt;proc~xerrwd</title>
<path fill="none" stroke="#000000" d="M54.06,-144.06C64.96,-140.04 77.89,-136 90,-134 117,-129.55 147.94,-130.02 171.36,-131.48"/>
<polygon fill="#000000" stroke="#000000" points="171.33,-134.99 181.56,-132.21 171.83,-128 171.33,-134.99"/>
</g>
<!-- proc~dstodi -->
<g id="proc~~dlsodi~~CallsGraph_node6" class="node">
<title>proc~dstodi</title>
<g id="a_proc~~dlsodi~~CallsGraph_node6"><a xlink:href=".././proc/dstodi.html" xlink:title="dstodi">
<polygon fill="#d9534f" stroke="#d9534f" points="145,-209 91,-209 91,-185 145,-185 145,-209"/>
<text text-anchor="middle" x="118" y="-194.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dstodi</text>
</a>
</g>
</g>
<!-- proc~dlsodi&#45;&gt;proc~dstodi -->
<g id="proc~~dlsodi~~CallsGraph_edge5" class="edge">
<title>proc~dlsodi&#45;&gt;proc~dstodi</title>
<path fill="none" stroke="#000000" d="M53.74,-167.15C62.6,-171.33 72.67,-176.08 82.13,-180.54"/>
<polygon fill="#000000" stroke="#000000" points="80.78,-183.78 91.32,-184.88 83.77,-177.45 80.78,-183.78"/>
</g>
<!-- proc~dewset -->
<g id="proc~~dlsodi~~CallsGraph_node7" class="node">
<title>proc~dewset</title>
<g id="a_proc~~dlsodi~~CallsGraph_node7"><a xlink:href=".././proc/dewset.html" xlink:title="dewset">
<polygon fill="#d9534f" stroke="#d9534f" points="145,-87 91,-87 91,-63 145,-63 145,-87"/>
<text text-anchor="middle" x="118" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dewset</text>
</a>
</g>
</g>
<!-- proc~dlsodi&#45;&gt;proc~dewset -->
<g id="proc~~dlsodi~~CallsGraph_edge6" class="edge">
<title>proc~dlsodi&#45;&gt;proc~dewset</title>
<path fill="none" stroke="#000000" d="M41.52,-142.85C55.98,-129.85 79.1,-109.07 95.95,-93.92"/>
<polygon fill="#000000" stroke="#000000" points="98.55,-96.29 103.65,-87 93.87,-91.08 98.55,-96.29"/>
</g>
<!-- proc~dainvg -->
<g id="proc~~dlsodi~~CallsGraph_node8" class="node">
<title>proc~dainvg</title>
<g id="a_proc~~dlsodi~~CallsGraph_node8"><a xlink:href=".././proc/dainvg.html" xlink:title="dainvg">
<polygon fill="#d9534f" stroke="#d9534f" points="145,-45 91,-45 91,-21 145,-21 145,-45"/>
<text text-anchor="middle" x="118" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dainvg</text>
</a>
</g>
</g>
<!-- proc~dlsodi&#45;&gt;proc~dainvg -->
<g id="proc~~dlsodi~~CallsGraph_edge7" class="edge">
<title>proc~dlsodi&#45;&gt;proc~dainvg</title>
<path fill="none" stroke="#000000" d="M33.65,-142.87C43.31,-122.91 64.48,-82.51 90,-54 90.62,-53.3 91.27,-52.61 91.94,-51.93"/>
<polygon fill="#000000" stroke="#000000" points="94.53,-54.31 99.63,-45.01 89.85,-49.1 94.53,-54.31"/>
</g>
<!-- proc~dintdy&#45;&gt;proc~xerrwd -->
<g id="proc~~dlsodi~~CallsGraph_edge8" class="edge">
<title>proc~dintdy&#45;&gt;proc~xerrwd</title>
<path fill="none" stroke="#000000" d="M145.22,-149.11C153.64,-147.22 163.12,-145.09 172.11,-143.07"/>
<polygon fill="#000000" stroke="#000000" points="172.98,-146.46 181.97,-140.85 171.44,-139.63 172.98,-146.46"/>
</g>
<!-- proc~dstodi&#45;&gt;proc~dvnorm -->
<g id="proc~~dlsodi~~CallsGraph_edge9" class="edge">
<title>proc~dstodi&#45;&gt;proc~dvnorm</title>
<path fill="none" stroke="#000000" d="M136.58,-209.25C149.59,-218.31 167.51,-230.79 182.14,-240.99"/>
<polygon fill="#000000" stroke="#000000" points="180.55,-244.14 190.76,-246.99 184.55,-238.4 180.55,-244.14"/>
</g>
<!-- proc~dcfode -->
<g id="proc~~dlsodi~~CallsGraph_node10" class="node">
<title>proc~dcfode</title>
<g id="a_proc~~dlsodi~~CallsGraph_node10"><a xlink:href=".././proc/dcfode.html" xlink:title="dcfode">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-209 182,-209 182,-185 236,-185 236,-209"/>
<text text-anchor="middle" x="209" y="-194.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcfode</text>
</a>
</g>
</g>
<!-- proc~dstodi&#45;&gt;proc~dcfode -->
<g id="proc~~dlsodi~~CallsGraph_edge10" class="edge">
<title>proc~dstodi&#45;&gt;proc~dcfode</title>
<path fill="none" stroke="#000000" d="M145.22,-197C153.55,-197 162.91,-197 171.82,-197"/>
<polygon fill="#000000" stroke="#000000" points="171.97,-200.5 181.97,-197 171.97,-193.5 171.97,-200.5"/>
</g>
<!-- proc~dgesl -->
<g id="proc~~dlsodi~~CallsGraph_node9" class="node">
<title>proc~dgesl</title>
<g id="a_proc~~dlsodi~~CallsGraph_node9"><a xlink:href=".././proc/dgesl.html" xlink:title="dgesl">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-24 182,-24 182,0 236,0 236,-24"/>
<text text-anchor="middle" x="209" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesl</text>
</a>
</g>
</g>
<!-- proc~dainvg&#45;&gt;proc~dgesl -->
<g id="proc~~dlsodi~~CallsGraph_edge11" class="edge">
<title>proc~dainvg&#45;&gt;proc~dgesl</title>
<path fill="none" stroke="#000000" d="M145.22,-26.81C153.64,-24.83 163.12,-22.59 172.11,-20.47"/>
<polygon fill="#000000" stroke="#000000" points="173.04,-23.85 181.97,-18.14 171.43,-17.03 173.04,-23.85"/>
</g>
<!-- proc~dgefa -->
<g id="proc~~dlsodi~~CallsGraph_node11" class="node">
<title>proc~dgefa</title>
<g id="a_proc~~dlsodi~~CallsGraph_node11"><a xlink:href=".././proc/dgefa.html" xlink:title="dgefa">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-66 182,-66 182,-42 236,-42 236,-66"/>
<text text-anchor="middle" x="209" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgefa</text>
</a>
</g>
</g>
<!-- proc~dainvg&#45;&gt;proc~dgefa -->
<g id="proc~~dlsodi~~CallsGraph_edge12" class="edge">
<title>proc~dainvg&#45;&gt;proc~dgefa</title>
<path fill="none" stroke="#000000" d="M145.22,-39.19C153.64,-41.17 163.12,-43.41 172.11,-45.53"/>
<polygon fill="#000000" stroke="#000000" points="171.43,-48.97 181.97,-47.86 173.04,-42.15 171.43,-48.97"/>
</g>
<!-- proc~daxpy -->
<g id="proc~~dlsodi~~CallsGraph_node13" class="node">
<title>proc~daxpy</title>
<g id="a_proc~~dlsodi~~CallsGraph_node13"><a xlink:href=".././proc/daxpy.html" xlink:title="daxpy">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-24 272,-24 272,0 326,0 326,-24"/>
<text text-anchor="middle" x="299" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">daxpy</text>
</a>
</g>
</g>
<!-- proc~dgesl&#45;&gt;proc~daxpy -->
<g id="proc~~dlsodi~~CallsGraph_edge13" class="edge">
<title>proc~dgesl&#45;&gt;proc~daxpy</title>
<path fill="none" stroke="#000000" d="M236.4,-12C244.39,-12 253.31,-12 261.82,-12"/>
<polygon fill="#000000" stroke="#000000" points="261.92,-15.5 271.92,-12 261.92,-8.5 261.92,-15.5"/>
</g>
<!-- proc~dscal -->
<g id="proc~~dlsodi~~CallsGraph_node12" class="node">
<title>proc~dscal</title>
<g id="a_proc~~dlsodi~~CallsGraph_node12"><a xlink:href=".././proc/dscal.html" xlink:title="dscal">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-66 272,-66 272,-42 326,-42 326,-66"/>
<text text-anchor="middle" x="299" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscal</text>
</a>
</g>
</g>
<!-- proc~dgefa&#45;&gt;proc~dscal -->
<g id="proc~~dlsodi~~CallsGraph_edge14" class="edge">
<title>proc~dgefa&#45;&gt;proc~dscal</title>
<path fill="none" stroke="#000000" d="M236.4,-54C244.39,-54 253.31,-54 261.82,-54"/>
<polygon fill="#000000" stroke="#000000" points="261.92,-57.5 271.92,-54 261.92,-50.5 261.92,-57.5"/>
</g>
<!-- proc~dgefa&#45;&gt;proc~daxpy -->
<g id="proc~~dlsodi~~CallsGraph_edge15" class="edge">
<title>proc~dgefa&#45;&gt;proc~daxpy</title>
<path fill="none" stroke="#000000" d="M235.45,-41.85C244.21,-37.67 254.17,-32.92 263.52,-28.46"/>
<polygon fill="#000000" stroke="#000000" points="265.09,-31.59 272.6,-24.12 262.07,-25.27 265.09,-31.59"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<em>None</em>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>odepack was developed by Alan C. Hindmarsh as modified by John S. Urban, Jacob Williams<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-02-03 03:45            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>